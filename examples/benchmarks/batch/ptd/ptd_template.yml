########################### import-time and call-time arguments specified here ###########################
# ==> Arguments section of the file <==

# - Call Batch.import_func(my_ptd_file.yml, *my_import_args, **my_import_kwargs) to get a function
#   that wraps the task specified my_ptd_file.yml
# - Import-time arguments are passed to Batch.import_func
# - Call-time arguments are passed to the imported function obtained from Batch.import_func
# - The identifiers used here for arguments can be anything--they're just names
# - Once an identifier has been specified here, it can be used below in the section for task definitions
# - It can also be used in this section, to specify a function or one of its arguments (see the example
#   below under "import_kwargs")
# - There can't be any overlap between import-time and call-time arguments, since it wouldn't be clear
#   which value to use
#
import_args:
  - a_list
  - of_args
  - goes_here
  - some_func
  - another_func
  - some_arg
  - mpi_job
  - my_env
  - base_dir

import_kwargs:
  # - The value for a key can either be a simple string (as in the case for my_key)
  # - Or it can be a function represented as a dictionary with a single key whose value is a list
  #   of arguments (as in the case for another_key)
  my_key: a_fixed_arg
  another_key:
    another_func:
      - a_fixed_arg
      - some_arg
  task_name: best_name_ever

# These are the positional arguments passed to the function obtained from Batch.import_func
args:
  - the_ddict
  - i
  - num_items

# kwargs:
# - Not every key has to be filled out. We can leave some commented out, although some are mandatory
# - The type key is necessary, since we need to know the type of task (function, process, or job)
# - There needs to be at least one executable specified, and all executables must specify a target

######### definition of task executables, resources, dependencies, etc. (in terms of args above) #########
# ==> Task definition section of the file <==

# Valid values here are: function, process, or job
type: job

executables:
  - target: mpi_job
    nprocs: 2
    args:
      - some_arg
      - a_fixed_arg
    # This string doesn't appear in the arguments section of the file, so it will be used literally
    cwd: hard_coded_cwd
    # The value passed in for new_env must be a dictionary
    env: my_env

  - target: mpi_job
    args:
      # This argument is some_func(some_arg)
      - some_func:
        - some_arg
      - the_ddict
      - i
      - num_items
    cwd: base_dir
    env: my_env

reads:
  - ddict: the_ddict
    keys:
      - i

writes:
  - ddict: the_ddict
    keys:
      # Only a single key is written: another_func(i, num_items)
      - another_func:
        - i
        - num_items

name: best_name_ever