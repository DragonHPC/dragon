<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>An example MPI workflow using Dragon ProcessGroup &mdash; Dragon  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Distributed Dragon Dictionary" href="dragon_dict.html" />
    <link rel="prev" title="Creating and Using a Queue in Dragon Native" href="dragon_native_queue.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Dragon
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../start/start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../uguide/uguide.html">Users Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pguide/pguide.html">Programming Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="cbook.html">Solution Cookbook</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="cbook.html#multiprocessing-with-dragon">Multiprocessing with Dragon</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="cbook.html#dragon-native">Dragon Native</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="dragon_native_pi.html">Calculating π using parallel Monte Carlo</a></li>
<li class="toctree-l3"><a class="reference internal" href="c_channels_demo.html">How To Use The C Channels API</a></li>
<li class="toctree-l3"><a class="reference internal" href="dragon_native_queue.html">Creating and Using a Queue in Dragon Native</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">An example MPI workflow using Dragon ProcessGroup</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="cbook.html#dragon-data-preview">Dragon Data (Preview)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../benchmarks/benchmarks.html">Benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ref/ref.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infrastructure/infrastructure.html">Infrastructure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../services/services.html">Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components/components.html">Low-level Components</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Dragon</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="cbook.html">Solution Cookbook</a></li>
      <li class="breadcrumb-item active">An example MPI workflow using Dragon ProcessGroup</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/cbook/dragon_mpi_workflow.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="an-example-mpi-workflow-using-dragon-processgroup">
<h1>An example MPI workflow using Dragon ProcessGroup<a class="headerlink" href="#an-example-mpi-workflow-using-dragon-processgroup" title="Permalink to this heading"></a></h1>
<p>This file establishes an example workflow of multiple coordinating
processes:</p>
<ul>
<li><p>Producers: Up to two concurrent producer processes are started
at any time, with a maximum of 5 producer processes run in total.
Each Producer process starts a MPI based job of up to half the
available cores within the multinode allocation. The Dragon
ProcessGroup API is used to efficiently start and manage the MPI
processes. When starting the MPI Processes, the stdout of the head MPI
process is redirected and made available via a Dragon Connection
object.</p>
<p>In this example the <code class="code docutils literal notranslate"><span class="pre">osu_alltoall</span></code> application is used to generate
pseudo random data that is fed to the Parser process.</p>
</li>
<li><p>Parser: Each producer process starts a single Parser process used
to transform the Producer output. The parser process reads from
the given Dragon Connection object to receive the stdout from its producer.
Received data is transformed until all data has been processed.
Transformed data is placed into a shared Results Queue and sent to the
Consumer process for post processing.</p></li>
<li><p>Consumer: The consumer process reads the transformed data from the
shared Results Queue and logs the values. Alternatively, the results
could be forwarded to another workflow for further processing.</p></li>
</ul>
<figure class="align-center" id="mpiworkflowpic">
<a class="reference internal image-reference" href="../_images/dragon_mpi_workflow.svg"><img alt="../_images/dragon_mpi_workflow.svg" height="402" src="../_images/dragon_mpi_workflow.svg" width="387" /></a>
</figure>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-number">Listing 20 </span><span class="caption-text">hpc_workflow_demo_highlevel.py: Example MPI based workflow example</span><a class="headerlink" href="#id1" title="Permalink to this code"></a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="kn">import</span> <span class="nn">os</span>
<span class="linenos">  2</span><span class="kn">import</span> <span class="nn">re</span>
<span class="linenos">  3</span><span class="kn">import</span> <span class="nn">logging</span>
<span class="linenos">  4</span><span class="kn">import</span> <span class="nn">queue</span>
<span class="linenos">  5</span>
<span class="linenos">  6</span><span class="kn">import</span> <span class="nn">dragon</span>
<span class="linenos">  7</span><span class="kn">import</span> <span class="nn">multiprocessing</span> <span class="k">as</span> <span class="nn">mp</span>
<span class="linenos">  8</span>
<span class="linenos">  9</span><span class="kn">from</span> <span class="nn">dragon.globalservices</span> <span class="kn">import</span> <span class="n">node</span>
<span class="linenos"> 10</span><span class="kn">from</span> <span class="nn">dragon.globalservices.process</span> <span class="kn">import</span> <span class="n">multi_join</span>
<span class="linenos"> 11</span><span class="kn">from</span> <span class="nn">dragon.infrastructure.connection</span> <span class="kn">import</span> <span class="n">Connection</span>
<span class="linenos"> 12</span><span class="kn">from</span> <span class="nn">dragon.native.process</span> <span class="kn">import</span> <span class="n">MSG_PIPE</span><span class="p">,</span> <span class="n">MSG_DEVNULL</span><span class="p">,</span> <span class="n">Process</span><span class="p">,</span> <span class="n">TemplateProcess</span>
<span class="linenos"> 13</span><span class="kn">from</span> <span class="nn">dragon.native.process_group</span> <span class="kn">import</span> <span class="n">ProcessGroup</span>
<span class="linenos"> 14</span>
<span class="linenos"> 15</span><span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="linenos"> 16</span>
<span class="linenos"> 17</span>
<span class="linenos"> 18</span><span class="k">def</span> <span class="nf">producer_proc</span><span class="p">(</span><span class="n">producer_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">num_ranks</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">result_queue</span><span class="p">:</span> <span class="n">mp</span><span class="o">.</span><span class="n">Queue</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 19</span>    <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 20</span><span class="sd">    The producer process will start `num_ranks` copies of the osu_alltoall</span>
<span class="linenos"> 21</span><span class="sd">    MPI application. The stdout output from the head process will be piped via</span>
<span class="linenos"> 22</span><span class="sd">    Dragon to a separate process responsible for parsing the osu_alltoall</span>
<span class="linenos"> 23</span><span class="sd">    results and putting the results onto the results queue.</span>
<span class="linenos"> 24</span>
<span class="linenos"> 25</span><span class="sd">    :param producer_id: Numerical id identifying this producer</span>
<span class="linenos"> 26</span><span class="sd">    :type producer_id: int</span>
<span class="linenos"> 27</span><span class="sd">    :param num_ranks: The number of MPI ranks to start</span>
<span class="linenos"> 28</span><span class="sd">    :type num_ranks: int</span>
<span class="linenos"> 29</span><span class="sd">    :param result_queue: Handle to a queue where the results should be placed</span>
<span class="linenos"> 30</span><span class="sd">    :type result_queue: mp.Queue</span>
<span class="linenos"> 31</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos"> 32</span>
<span class="linenos"> 33</span>    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="linenos"> 34</span>    <span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;producer </span><span class="si">{</span><span class="n">producer_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos"> 35</span>    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting producer (num_ranks=</span><span class="si">%d</span><span class="s2">)&quot;</span><span class="p">,</span> <span class="n">num_ranks</span><span class="p">)</span>
<span class="linenos"> 36</span>
<span class="linenos"> 37</span>    <span class="n">exe</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">(),</span> <span class="s2">&quot;osu_alltoall&quot;</span><span class="p">)</span>
<span class="linenos"> 38</span>    <span class="n">args</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;--warmup&quot;</span><span class="p">,</span> <span class="s2">&quot;10&quot;</span><span class="p">,</span> <span class="s2">&quot;-m&quot;</span><span class="p">,</span> <span class="s2">&quot;4096&quot;</span><span class="p">]</span>
<span class="linenos"> 39</span>    <span class="n">run_dir</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
<span class="linenos"> 40</span>
<span class="linenos"> 41</span>    <span class="n">grp</span> <span class="o">=</span> <span class="n">ProcessGroup</span><span class="p">(</span><span class="n">restart</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pmi_enabled</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="linenos"> 42</span>
<span class="linenos"> 43</span>    <span class="c1"># Pipe the stdout output from the head process to a Dragon connection</span>
<span class="linenos"> 44</span>    <span class="n">grp</span><span class="o">.</span><span class="n">add_process</span><span class="p">(</span>
<span class="linenos"> 45</span>        <span class="n">nproc</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="linenos"> 46</span>        <span class="n">template</span><span class="o">=</span><span class="n">TemplateProcess</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">exe</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span> <span class="n">cwd</span><span class="o">=</span><span class="n">run_dir</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">MSG_PIPE</span><span class="p">)</span>
<span class="linenos"> 47</span>    <span class="p">)</span>
<span class="linenos"> 48</span>
<span class="linenos"> 49</span>    <span class="c1"># All other ranks should have their output go to DEVNULL</span>
<span class="linenos"> 50</span>    <span class="n">grp</span><span class="o">.</span><span class="n">add_process</span><span class="p">(</span>
<span class="linenos"> 51</span>        <span class="n">nproc</span><span class="o">=</span><span class="n">num_ranks</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>
<span class="linenos"> 52</span>        <span class="n">template</span><span class="o">=</span><span class="n">TemplateProcess</span><span class="p">(</span><span class="n">target</span><span class="o">=</span><span class="n">exe</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">args</span><span class="p">,</span> <span class="n">cwd</span><span class="o">=</span><span class="n">run_dir</span><span class="p">,</span> <span class="n">stdout</span><span class="o">=</span><span class="n">MSG_DEVNULL</span><span class="p">)</span>
<span class="linenos"> 53</span>    <span class="p">)</span>
<span class="linenos"> 54</span>
<span class="linenos"> 55</span>    <span class="n">grp</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<span class="linenos"> 56</span>    <span class="n">grp</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="linenos"> 57</span>    <span class="n">child_resources</span> <span class="o">=</span> <span class="p">[</span><span class="n">Process</span><span class="p">(</span><span class="kc">None</span><span class="p">,</span> <span class="n">ident</span><span class="o">=</span><span class="n">puid</span><span class="p">)</span> <span class="k">for</span> <span class="n">puid</span> <span class="ow">in</span> <span class="n">grp</span><span class="o">.</span><span class="n">puids</span><span class="p">]</span>
<span class="linenos"> 58</span>    <span class="n">parser_proc</span> <span class="o">=</span> <span class="kc">None</span>
<span class="linenos"> 59</span>    <span class="n">ranks_per_node</span> <span class="o">=</span> <span class="p">{</span><span class="n">n</span><span class="p">:</span> <span class="mi">0</span> <span class="k">for</span> <span class="n">n</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">get_list</span><span class="p">()))}</span>
<span class="linenos"> 60</span>    <span class="k">for</span> <span class="n">child_resource</span> <span class="ow">in</span> <span class="n">child_resources</span><span class="p">:</span>
<span class="linenos"> 61</span>        <span class="n">ranks_per_node</span><span class="p">[</span><span class="n">child_resource</span><span class="o">.</span><span class="n">node</span><span class="p">]</span> <span class="o">=</span> <span class="n">ranks_per_node</span><span class="p">[</span><span class="n">child_resource</span><span class="o">.</span><span class="n">node</span><span class="p">]</span> <span class="o">+</span> <span class="mi">1</span>
<span class="linenos"> 62</span>        <span class="k">if</span> <span class="n">child_resource</span><span class="o">.</span><span class="n">stdout_conn</span><span class="p">:</span>
<span class="linenos"> 63</span>            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting parse_results process for puid=</span><span class="si">%d</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">child_resource</span><span class="o">.</span><span class="n">puid</span><span class="p">)</span>
<span class="linenos"> 64</span>            <span class="n">parser_proc</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span>
<span class="linenos"> 65</span>                <span class="n">target</span><span class="o">=</span><span class="n">parse_results_proc</span><span class="p">,</span>
<span class="linenos"> 66</span>                <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">producer_id</span><span class="p">,</span> <span class="n">child_resource</span><span class="o">.</span><span class="n">stdout_conn</span><span class="p">,</span> <span class="n">result_queue</span><span class="p">),</span>
<span class="linenos"> 67</span>            <span class="p">)</span>
<span class="linenos"> 68</span>            <span class="n">parser_proc</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="linenos"> 69</span>
<span class="linenos"> 70</span>    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;, &quot;</span><span class="o">.</span><span class="n">join</span><span class="p">([</span><span class="sa">f</span><span class="s2">&quot;node </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2"> has </span><span class="si">{</span><span class="n">r</span><span class="si">}</span><span class="s2"> ranks&quot;</span> <span class="k">for</span> <span class="n">n</span><span class="p">,</span> <span class="n">r</span> <span class="ow">in</span> <span class="n">ranks_per_node</span><span class="o">.</span><span class="n">items</span><span class="p">()]))</span>
<span class="linenos"> 71</span>    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Waiting for group to finish&quot;</span><span class="p">)</span>
<span class="linenos"> 72</span>    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">child_resources</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
<span class="linenos"> 73</span>        <span class="n">grp</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
<span class="linenos"> 74</span>
<span class="linenos"> 75</span>    <span class="k">if</span> <span class="n">parser_proc</span><span class="p">:</span>
<span class="linenos"> 76</span>        <span class="n">parser_proc</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
<span class="linenos"> 77</span>
<span class="linenos"> 78</span>    <span class="n">grp</span><span class="o">.</span><span class="n">stop</span><span class="p">()</span>
<span class="linenos"> 79</span>
<span class="linenos"> 80</span>    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Done&quot;</span><span class="p">)</span>
<span class="linenos"> 81</span>
<span class="linenos"> 82</span>
<span class="linenos"> 83</span><span class="k">def</span> <span class="nf">parse_results_proc</span><span class="p">(</span><span class="n">producer_id</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span> <span class="n">stdout_conn</span><span class="p">:</span> <span class="n">Connection</span><span class="p">,</span> <span class="n">result_queue</span><span class="p">:</span> <span class="n">mp</span><span class="o">.</span><span class="n">Queue</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos"> 84</span>    <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos"> 85</span><span class="sd">    Read stdout from the Dragon connection. Parse statistical data</span>
<span class="linenos"> 86</span><span class="sd">    and put onto result queue.</span>
<span class="linenos"> 87</span>
<span class="linenos"> 88</span><span class="sd">    :param producer_id: Numerical id identifying this producer</span>
<span class="linenos"> 89</span><span class="sd">    :type producer_id: int</span>
<span class="linenos"> 90</span><span class="sd">    :param stdout_conn: Dragon Connection object to read stdout data from</span>
<span class="linenos"> 91</span><span class="sd">    :type stdout_conn: Connection</span>
<span class="linenos"> 92</span><span class="sd">    :param result_queue: Handle to a queue where the results should be placed</span>
<span class="linenos"> 93</span><span class="sd">    :type result_queue: mp.Queue</span>
<span class="linenos"> 94</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos"> 95</span>
<span class="linenos"> 96</span>    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="linenos"> 97</span>    <span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;parse_results </span><span class="si">{</span><span class="n">producer_id</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos"> 98</span>    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Parsing stdout from stdout connection&quot;</span><span class="p">)</span>
<span class="linenos"> 99</span>
<span class="linenos">100</span>    <span class="k">try</span><span class="p">:</span>
<span class="linenos">101</span>        <span class="n">result_matcher</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;^(\d+)\s+([\d.]+)&quot;</span><span class="p">)</span>
<span class="linenos">102</span>        <span class="k">while</span> <span class="kc">True</span><span class="p">:</span>
<span class="linenos">103</span>            <span class="n">line</span> <span class="o">=</span> <span class="n">stdout_conn</span><span class="o">.</span><span class="n">recv</span><span class="p">()</span>
<span class="linenos">104</span>            <span class="n">result</span> <span class="o">=</span> <span class="n">result_matcher</span><span class="o">.</span><span class="n">search</span><span class="p">(</span><span class="n">line</span><span class="p">)</span>
<span class="linenos">105</span>            <span class="k">if</span> <span class="n">result</span><span class="p">:</span>
<span class="linenos">106</span>                <span class="n">result_queue</span><span class="o">.</span><span class="n">put</span><span class="p">(</span>
<span class="linenos">107</span>                    <span class="p">{</span>
<span class="linenos">108</span>                        <span class="n">producer_id</span><span class="p">:</span> <span class="p">(</span>
<span class="linenos">109</span>                            <span class="n">result</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>
<span class="linenos">110</span>                            <span class="n">result</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span>
<span class="linenos">111</span>                        <span class="p">)</span>
<span class="linenos">112</span>                    <span class="p">}</span>
<span class="linenos">113</span>                <span class="p">)</span>
<span class="linenos">114</span>    <span class="k">except</span> <span class="ne">EOFError</span><span class="p">:</span>
<span class="linenos">115</span>        <span class="k">pass</span>
<span class="linenos">116</span>
<span class="linenos">117</span>    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Done&quot;</span><span class="p">)</span>
<span class="linenos">118</span>
<span class="linenos">119</span>
<span class="linenos">120</span><span class="k">def</span> <span class="nf">consumer_proc</span><span class="p">(</span><span class="n">result_queue</span><span class="p">:</span> <span class="n">mp</span><span class="o">.</span><span class="n">Queue</span><span class="p">,</span> <span class="n">shutdown_event</span><span class="p">:</span> <span class="n">mp</span><span class="o">.</span><span class="n">Event</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">121</span>    <span class="sd">&quot;&quot;&quot;</span>
<span class="linenos">122</span><span class="sd">    Read the values out of the result queue and</span>
<span class="linenos">123</span><span class="sd">    just print them to the log</span>
<span class="linenos">124</span>
<span class="linenos">125</span><span class="sd">    :param result_queue: Handle to a queue where the results should be placed</span>
<span class="linenos">126</span><span class="sd">    :type result_queue: mp.Queue</span>
<span class="linenos">127</span><span class="sd">    :param shutdown_event: Event used to signal that the consumer process should exit</span>
<span class="linenos">128</span><span class="sd">    :type shutdown_event: mp.Event</span>
<span class="linenos">129</span><span class="sd">    &quot;&quot;&quot;</span>
<span class="linenos">130</span>
<span class="linenos">131</span>    <span class="n">logging</span><span class="o">.</span><span class="n">basicConfig</span><span class="p">(</span><span class="n">level</span><span class="o">=</span><span class="n">logging</span><span class="o">.</span><span class="n">INFO</span><span class="p">)</span>
<span class="linenos">132</span>    <span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;consumer&quot;</span><span class="p">)</span>
<span class="linenos">133</span>    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;reading from result_queue&quot;</span><span class="p">)</span>
<span class="linenos">134</span>
<span class="linenos">135</span>    <span class="k">while</span> <span class="ow">not</span> <span class="n">shutdown_event</span><span class="o">.</span><span class="n">is_set</span><span class="p">():</span>
<span class="linenos">136</span>        <span class="k">try</span><span class="p">:</span>
<span class="linenos">137</span>            <span class="n">values</span> <span class="o">=</span> <span class="n">result_queue</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">timeout</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="linenos">138</span>            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">values</span><span class="p">)</span>
<span class="linenos">139</span>        <span class="k">except</span> <span class="n">queue</span><span class="o">.</span><span class="n">Empty</span><span class="p">:</span>
<span class="linenos">140</span>            <span class="k">pass</span>
<span class="linenos">141</span>
<span class="linenos">142</span>    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Done&quot;</span><span class="p">)</span>
<span class="linenos">143</span>
<span class="linenos">144</span>
<span class="linenos">145</span><span class="k">def</span> <span class="nf">main</span><span class="p">()</span> <span class="o">-&gt;</span> <span class="kc">None</span><span class="p">:</span>
<span class="linenos">146</span>    <span class="n">mp</span><span class="o">.</span><span class="n">set_start_method</span><span class="p">(</span><span class="s2">&quot;dragon&quot;</span><span class="p">)</span>
<span class="linenos">147</span>
<span class="linenos">148</span>    <span class="n">log</span> <span class="o">=</span> <span class="n">logging</span><span class="o">.</span><span class="n">getLogger</span><span class="p">(</span><span class="s2">&quot;main&quot;</span><span class="p">)</span>
<span class="linenos">149</span>
<span class="linenos">150</span>    <span class="n">result_queue</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Queue</span><span class="p">()</span>
<span class="linenos">151</span>
<span class="linenos">152</span>    <span class="n">total_runs</span> <span class="o">=</span> <span class="mi">5</span>
<span class="linenos">153</span>    <span class="n">current_runs</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos">154</span>    <span class="n">simultaneous_producers</span> <span class="o">=</span> <span class="mi">2</span>
<span class="linenos">155</span>    <span class="n">producer_num</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos">156</span>
<span class="linenos">157</span>    <span class="n">num_nodes</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">node</span><span class="o">.</span><span class="n">get_list</span><span class="p">())</span>
<span class="linenos">158</span>    <span class="n">reserved_cores</span> <span class="o">=</span> <span class="p">(</span>
<span class="linenos">159</span>        <span class="n">num_nodes</span> <span class="o">*</span> <span class="mi">2</span>
<span class="linenos">160</span>    <span class="p">)</span>  <span class="c1"># Reserve a couple of cores for Dragon infrastructure</span>
<span class="linenos">161</span>    <span class="n">num_real_cores</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">cpu_count</span><span class="p">()</span> <span class="o">//</span> <span class="mi">2</span>
<span class="linenos">162</span>    <span class="n">ranks_per_job</span> <span class="o">=</span> <span class="p">(</span><span class="n">num_real_cores</span> <span class="o">-</span> <span class="n">reserved_cores</span><span class="p">)</span> <span class="o">//</span> <span class="n">simultaneous_producers</span>
<span class="linenos">163</span>
<span class="linenos">164</span>    <span class="n">shutdown_event</span> <span class="o">=</span> <span class="n">mp</span><span class="o">.</span><span class="n">Event</span><span class="p">()</span>
<span class="linenos">165</span>    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting consumer process&quot;</span><span class="p">)</span>
<span class="linenos">166</span>    <span class="n">consumer</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span>
<span class="linenos">167</span>        <span class="n">target</span><span class="o">=</span><span class="n">consumer_proc</span><span class="p">,</span>
<span class="linenos">168</span>        <span class="n">args</span><span class="o">=</span><span class="p">(</span>
<span class="linenos">169</span>            <span class="n">result_queue</span><span class="p">,</span>
<span class="linenos">170</span>            <span class="n">shutdown_event</span><span class="p">,</span>
<span class="linenos">171</span>        <span class="p">),</span>
<span class="linenos">172</span>    <span class="p">)</span>
<span class="linenos">173</span>    <span class="n">consumer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="linenos">174</span>
<span class="linenos">175</span>    <span class="n">producers</span> <span class="o">=</span> <span class="nb">set</span><span class="p">()</span>
<span class="linenos">176</span>    <span class="n">active_producers</span> <span class="o">=</span> <span class="mi">0</span>
<span class="linenos">177</span>    <span class="k">while</span> <span class="n">current_runs</span> <span class="o">&lt;</span> <span class="n">total_runs</span><span class="p">:</span>
<span class="linenos">178</span>        <span class="k">while</span> <span class="n">active_producers</span> <span class="o">&lt;</span> <span class="nb">min</span><span class="p">(</span><span class="n">simultaneous_producers</span><span class="p">,</span> <span class="n">total_runs</span> <span class="o">-</span> <span class="n">current_runs</span><span class="p">):</span>
<span class="linenos">179</span>            <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Starting a new producer&quot;</span><span class="p">)</span>
<span class="linenos">180</span>            <span class="n">producer</span> <span class="o">=</span> <span class="n">Process</span><span class="p">(</span>
<span class="linenos">181</span>                <span class="n">target</span><span class="o">=</span><span class="n">producer_proc</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">producer_num</span><span class="p">,</span> <span class="n">ranks_per_job</span><span class="p">,</span> <span class="n">result_queue</span><span class="p">)</span>
<span class="linenos">182</span>            <span class="p">)</span>
<span class="linenos">183</span>            <span class="n">producer</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
<span class="linenos">184</span>            <span class="n">producers</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">producer</span><span class="o">.</span><span class="n">puid</span><span class="p">)</span>
<span class="linenos">185</span>            <span class="n">active_producers</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="linenos">186</span>            <span class="n">producer_num</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="linenos">187</span>
<span class="linenos">188</span>        <span class="n">exited_list</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">multi_join</span><span class="p">(</span><span class="n">producers</span><span class="p">,</span> <span class="n">join_all</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="linenos">189</span>        <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;at least one producer has exited&quot;</span><span class="p">)</span>
<span class="linenos">190</span>        <span class="n">exited_puids</span> <span class="o">=</span> <span class="p">[]</span> <span class="k">if</span> <span class="n">exited_list</span> <span class="ow">is</span> <span class="kc">None</span> <span class="k">else</span> <span class="p">[</span><span class="n">puid</span> <span class="k">for</span> <span class="n">puid</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">exited_list</span><span class="p">]</span>
<span class="linenos">191</span>        <span class="n">current_runs</span> <span class="o">=</span> <span class="n">current_runs</span> <span class="o">+</span> <span class="nb">len</span><span class="p">(</span><span class="n">exited_puids</span><span class="p">)</span>
<span class="linenos">192</span>        <span class="n">active_producers</span> <span class="o">=</span> <span class="n">active_producers</span> <span class="o">-</span> <span class="nb">len</span><span class="p">(</span><span class="n">exited_puids</span><span class="p">)</span>
<span class="linenos">193</span>        <span class="n">producers</span> <span class="o">-=</span> <span class="nb">set</span><span class="p">(</span><span class="n">exited_puids</span><span class="p">)</span>
<span class="linenos">194</span>
<span class="linenos">195</span>    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Shutting down&quot;</span><span class="p">)</span>
<span class="linenos">196</span>    <span class="n">shutdown_event</span><span class="o">.</span><span class="n">set</span><span class="p">()</span>
<span class="linenos">197</span>    <span class="n">consumer</span><span class="o">.</span><span class="n">join</span><span class="p">()</span>
<span class="linenos">198</span>    <span class="n">log</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s2">&quot;Done&quot;</span><span class="p">)</span>
<span class="linenos">199</span>
<span class="linenos">200</span>
<span class="linenos">201</span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="linenos">202</span>    <span class="n">main</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>The program output can be seen below:</p>
<div class="literal-block-wrapper docutils container" id="id2">
<div class="code-block-caption"><span class="caption-number">Listing 21 </span><span class="caption-text"><strong>Output when running hpc_workflow_demo_highlevel.py</strong></span><a class="headerlink" href="#id2" title="Permalink to this code"></a></div>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="go">&gt;$dragon hpc_workflow_demo_highlevel.py</span>
<span class="linenos">  2</span><span class="go">INFO:api_setup:We are registering gateways for this process. dp.this_process.num_gw_channels_per_node=1</span>
<span class="linenos">  3</span><span class="go">INFO:api_setup:connecting to infrastructure from 117921</span>
<span class="linenos">  4</span><span class="go">INFO:api_setup:debug entry hooked</span>
<span class="linenos">  5</span><span class="go">INFO:main:Starting consumer process</span>
<span class="linenos">  6</span><span class="go">INFO:main:Starting a new producer</span>
<span class="linenos">  7</span><span class="go">INFO:main:Starting a new producer</span>
<span class="linenos">  8</span><span class="go">INFO:producer 0:Starting producer (num_ranks=252)</span>
<span class="linenos">  9</span><span class="go">INFO:consumer:reading from result_queue</span>
<span class="linenos"> 10</span><span class="go">INFO:producer 1:Starting producer (num_ranks=252)</span>
<span class="linenos"> 11</span><span class="go">INFO:producer 0:Starting parse_results process for puid=4294967302</span>
<span class="linenos"> 12</span><span class="go">INFO:producer 0:node 0 has 63 ranks, node 1 has 63 ranks, node 2 has 63 ranks, node 3 has 63 ranks</span>
<span class="linenos"> 13</span><span class="go">INFO:producer 0:Waiting for group to finish</span>
<span class="linenos"> 14</span><span class="go">INFO:parse_results 0:Parsing stdout from stdout connection</span>
<span class="linenos"> 15</span><span class="go">INFO:producer 1:Starting parse_results process for puid=4294967554</span>
<span class="linenos"> 16</span><span class="go">INFO:producer 1:node 0 has 63 ranks, node 1 has 63 ranks, node 2 has 63 ranks, node 3 has 63 ranks</span>
<span class="linenos"> 17</span><span class="go">INFO:producer 1:Waiting for group to finish</span>
<span class="linenos"> 18</span><span class="go">INFO:parse_results 1:Parsing stdout from stdout connection</span>
<span class="linenos"> 19</span><span class="go">INFO:consumer:{0: (&#39;1&#39;, &#39;65.12&#39;)}</span>
<span class="linenos"> 20</span><span class="go">INFO:consumer:{0: (&#39;2&#39;, &#39;62.65&#39;)}</span>
<span class="linenos"> 21</span><span class="go">INFO:consumer:{0: (&#39;4&#39;, &#39;62.30&#39;)}</span>
<span class="linenos"> 22</span><span class="go">INFO:consumer:{0: (&#39;8&#39;, &#39;68.07&#39;)}</span>
<span class="linenos"> 23</span><span class="go">INFO:consumer:{1: (&#39;1&#39;, &#39;63.97&#39;)}</span>
<span class="linenos"> 24</span><span class="go">INFO:consumer:{0: (&#39;16&#39;, &#39;77.03&#39;)}</span>
<span class="linenos"> 25</span><span class="go">INFO:consumer:{1: (&#39;2&#39;, &#39;68.60&#39;)}</span>
<span class="linenos"> 26</span><span class="go">INFO:consumer:{0: (&#39;32&#39;, &#39;93.42&#39;)}</span>
<span class="linenos"> 27</span><span class="go">INFO:consumer:{1: (&#39;4&#39;, &#39;74.10&#39;)}</span>
<span class="linenos"> 28</span><span class="go">INFO:consumer:{0: (&#39;64&#39;, &#39;137.70&#39;)}</span>
<span class="linenos"> 29</span><span class="go">INFO:consumer:{1: (&#39;8&#39;, &#39;81.51&#39;)}</span>
<span class="linenos"> 30</span><span class="go">INFO:consumer:{1: (&#39;16&#39;, &#39;86.40&#39;)}</span>
<span class="linenos"> 31</span><span class="go">INFO:consumer:{1: (&#39;32&#39;, &#39;101.93&#39;)}</span>
<span class="linenos"> 32</span><span class="go">INFO:consumer:{0: (&#39;128&#39;, &#39;322.11&#39;)}</span>
<span class="linenos"> 33</span><span class="go">INFO:consumer:{1: (&#39;64&#39;, &#39;176.49&#39;)}</span>
<span class="linenos"> 34</span><span class="go">INFO:consumer:{1: (&#39;128&#39;, &#39;415.66&#39;)}</span>
<span class="linenos"> 35</span><span class="go">INFO:consumer:{0: (&#39;256&#39;, &#39;662.86&#39;)}</span>
<span class="linenos"> 36</span><span class="go">INFO:consumer:{1: (&#39;256&#39;, &#39;815.32&#39;)}</span>
<span class="linenos"> 37</span><span class="go">INFO:consumer:{0: (&#39;512&#39;, &#39;1437.74&#39;)}</span>
<span class="linenos"> 38</span><span class="go">INFO:consumer:{1: (&#39;512&#39;, &#39;1306.46&#39;)}</span>
<span class="linenos"> 39</span><span class="go">INFO:consumer:{0: (&#39;1024&#39;, &#39;1288.51&#39;)}</span>
<span class="linenos"> 40</span><span class="go">INFO:consumer:{1: (&#39;1024&#39;, &#39;1400.14&#39;)}</span>
<span class="linenos"> 41</span><span class="go">INFO:consumer:{0: (&#39;2048&#39;, &#39;2137.02&#39;)}</span>
<span class="linenos"> 42</span><span class="go">INFO:consumer:{1: (&#39;2048&#39;, &#39;2839.61&#39;)}</span>
<span class="linenos"> 43</span><span class="go">INFO:consumer:{0: (&#39;4096&#39;, &#39;4095.24&#39;)}</span>
<span class="linenos"> 44</span><span class="go">INFO:parse_results 0:Done</span>
<span class="linenos"> 45</span><span class="go">INFO:consumer:{1: (&#39;4096&#39;, &#39;3611.41&#39;)}</span>
<span class="linenos"> 46</span><span class="go">INFO:producer 0:Done</span>
<span class="linenos"> 47</span><span class="go">INFO:main:at least one producer has exited</span>
<span class="linenos"> 48</span><span class="go">INFO:main:Starting a new producer</span>
<span class="linenos"> 49</span><span class="go">INFO:parse_results 1:Done</span>
<span class="linenos"> 50</span><span class="go">INFO:producer 2:Starting producer (num_ranks=252)</span>
<span class="linenos"> 51</span><span class="go">INFO:producer 1:Done</span>
<span class="linenos"> 52</span><span class="go">INFO:main:at least one producer has exited</span>
<span class="linenos"> 53</span><span class="go">INFO:main:Starting a new producer</span>
<span class="linenos"> 54</span><span class="go">INFO:producer 3:Starting producer (num_ranks=252)</span>
<span class="linenos"> 55</span><span class="go">INFO:producer 2:Starting parse_results process for puid=4294967811</span>
<span class="linenos"> 56</span><span class="go">INFO:producer 2:node 0 has 63 ranks, node 1 has 63 ranks, node 2 has 63 ranks, node 3 has 63 ranks</span>
<span class="linenos"> 57</span><span class="go">INFO:producer 2:Waiting for group to finish</span>
<span class="linenos"> 58</span><span class="go">INFO:parse_results 2:Parsing stdout from stdout connection</span>
<span class="linenos"> 59</span><span class="go">INFO:consumer:{2: (&#39;1&#39;, &#39;48.48&#39;)}</span>
<span class="linenos"> 60</span><span class="go">INFO:consumer:{2: (&#39;2&#39;, &#39;48.84&#39;)}</span>
<span class="linenos"> 61</span><span class="go">INFO:consumer:{2: (&#39;4&#39;, &#39;50.06&#39;)}</span>
<span class="linenos"> 62</span><span class="go">INFO:consumer:{2: (&#39;8&#39;, &#39;54.24&#39;)}</span>
<span class="linenos"> 63</span><span class="go">INFO:consumer:{2: (&#39;16&#39;, &#39;63.57&#39;)}</span>
<span class="linenos"> 64</span><span class="go">INFO:consumer:{2: (&#39;32&#39;, &#39;80.13&#39;)}</span>
<span class="linenos"> 65</span><span class="go">INFO:consumer:{2: (&#39;64&#39;, &#39;122.75&#39;)}</span>
<span class="linenos"> 66</span><span class="go">INFO:consumer:{2: (&#39;128&#39;, &#39;248.06&#39;)}</span>
<span class="linenos"> 67</span><span class="go">INFO:consumer:{2: (&#39;256&#39;, &#39;478.18&#39;)}</span>
<span class="linenos"> 68</span><span class="go">INFO:consumer:{2: (&#39;512&#39;, &#39;937.72&#39;)}</span>
<span class="linenos"> 69</span><span class="go">INFO:consumer:{2: (&#39;1024&#39;, &#39;675.31&#39;)}</span>
<span class="linenos"> 70</span><span class="go">INFO:consumer:{2: (&#39;2048&#39;, &#39;1259.17&#39;)}</span>
<span class="linenos"> 71</span><span class="go">INFO:producer 3:Starting parse_results process for puid=4294968065</span>
<span class="linenos"> 72</span><span class="go">INFO:producer 3:node 0 has 63 ranks, node 1 has 63 ranks, node 2 has 63 ranks, node 3 has 63 ranks</span>
<span class="linenos"> 73</span><span class="go">INFO:producer 3:Waiting for group to finish</span>
<span class="linenos"> 74</span><span class="go">INFO:parse_results 3:Parsing stdout from stdout connection</span>
<span class="linenos"> 75</span><span class="go">INFO:consumer:{3: (&#39;1&#39;, &#39;280.64&#39;)}</span>
<span class="linenos"> 76</span><span class="go">INFO:consumer:{3: (&#39;2&#39;, &#39;281.76&#39;)}</span>
<span class="linenos"> 77</span><span class="go">INFO:consumer:{3: (&#39;4&#39;, &#39;282.04&#39;)}</span>
<span class="linenos"> 78</span><span class="go">INFO:consumer:{2: (&#39;4096&#39;, &#39;2412.99&#39;)}</span>
<span class="linenos"> 79</span><span class="go">INFO:consumer:{3: (&#39;8&#39;, &#39;265.82&#39;)}</span>
<span class="linenos"> 80</span><span class="go">INFO:consumer:{3: (&#39;16&#39;, &#39;64.42&#39;)}</span>
<span class="linenos"> 81</span><span class="go">INFO:parse_results 2:Done</span>
<span class="linenos"> 82</span><span class="go">INFO:consumer:{3: (&#39;32&#39;, &#39;83.40&#39;)}</span>
<span class="linenos"> 83</span><span class="go">INFO:consumer:{3: (&#39;64&#39;, &#39;122.75&#39;)}</span>
<span class="linenos"> 84</span><span class="go">INFO:consumer:{3: (&#39;128&#39;, &#39;262.51&#39;)}</span>
<span class="linenos"> 85</span><span class="go">INFO:producer 2:Done</span>
<span class="linenos"> 86</span><span class="go">INFO:main:at least one producer has exited</span>
<span class="linenos"> 87</span><span class="go">INFO:main:Starting a new producer</span>
<span class="linenos"> 88</span><span class="go">INFO:consumer:{3: (&#39;256&#39;, &#39;487.71&#39;)}</span>
<span class="linenos"> 89</span><span class="go">INFO:producer 4:Starting producer (num_ranks=252)</span>
<span class="linenos"> 90</span><span class="go">INFO:consumer:{3: (&#39;512&#39;, &#39;951.84&#39;)}</span>
<span class="linenos"> 91</span><span class="go">INFO:consumer:{3: (&#39;1024&#39;, &#39;662.71&#39;)}</span>
<span class="linenos"> 92</span><span class="go">INFO:consumer:{3: (&#39;2048&#39;, &#39;1246.95&#39;)}</span>
<span class="linenos"> 93</span><span class="go">INFO:consumer:{3: (&#39;4096&#39;, &#39;2343.83&#39;)}</span>
<span class="linenos"> 94</span><span class="go">INFO:parse_results 3:Done</span>
<span class="linenos"> 95</span><span class="go">INFO:producer 4:Starting parse_results process for puid=4294968320</span>
<span class="linenos"> 96</span><span class="go">INFO:producer 4:node 0 has 63 ranks, node 1 has 63 ranks, node 2 has 63 ranks, node 3 has 63 ranks</span>
<span class="linenos"> 97</span><span class="go">INFO:producer 4:Waiting for group to finish</span>
<span class="linenos"> 98</span><span class="go">INFO:producer 3:Done</span>
<span class="linenos"> 99</span><span class="go">INFO:main:at least one producer has exited</span>
<span class="linenos">100</span><span class="go">INFO:parse_results 4:Parsing stdout from stdout connection</span>
<span class="linenos">101</span><span class="go">INFO:consumer:{4: (&#39;1&#39;, &#39;48.31&#39;)}</span>
<span class="linenos">102</span><span class="go">INFO:consumer:{4: (&#39;2&#39;, &#39;48.77&#39;)}</span>
<span class="linenos">103</span><span class="go">INFO:consumer:{4: (&#39;4&#39;, &#39;50.00&#39;)}</span>
<span class="linenos">104</span><span class="go">INFO:consumer:{4: (&#39;8&#39;, &#39;56.37&#39;)}</span>
<span class="linenos">105</span><span class="go">INFO:consumer:{4: (&#39;16&#39;, &#39;64.84&#39;)}</span>
<span class="linenos">106</span><span class="go">INFO:consumer:{4: (&#39;32&#39;, &#39;80.25&#39;)}</span>
<span class="linenos">107</span><span class="go">INFO:consumer:{4: (&#39;64&#39;, &#39;121.91&#39;)}</span>
<span class="linenos">108</span><span class="go">INFO:consumer:{4: (&#39;128&#39;, &#39;260.55&#39;)}</span>
<span class="linenos">109</span><span class="go">INFO:consumer:{4: (&#39;256&#39;, &#39;497.78&#39;)}</span>
<span class="linenos">110</span><span class="go">INFO:consumer:{4: (&#39;512&#39;, &#39;971.32&#39;)}</span>
<span class="linenos">111</span><span class="go">INFO:consumer:{4: (&#39;1024&#39;, &#39;694.80&#39;)}</span>
<span class="linenos">112</span><span class="go">INFO:consumer:{4: (&#39;2048&#39;, &#39;1281.18&#39;)}</span>
<span class="linenos">113</span><span class="go">INFO:consumer:{4: (&#39;4096&#39;, &#39;2374.38&#39;)}</span>
<span class="linenos">114</span><span class="go">INFO:parse_results 4:Done</span>
<span class="linenos">115</span><span class="go">INFO:producer 4:Done</span>
<span class="linenos">116</span><span class="go">INFO:main:at least one producer has exited</span>
<span class="linenos">117</span><span class="go">INFO:main:Shutting down</span>
<span class="linenos">118</span><span class="go">INFO:consumer:Done</span>
<span class="linenos">119</span><span class="go">INFO:main:Done</span>
</pre></div>
</div>
</div>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="dragon_native_queue.html" class="btn btn-neutral float-left" title="Creating and Using a Queue in Dragon Native" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="dragon_dict.html" class="btn btn-neutral float-right" title="Distributed Dragon Dictionary" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Hewlett Packard Enterprise.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>