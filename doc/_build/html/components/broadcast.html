<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Broadcast Component &mdash; Dragon  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="prev" title="Unordered Map" href="unordered_map.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Dragon
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../start/start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../uguide/uguide.html">Users Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pguide/pguide.html">Programming Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cbook/cbook.html">Solution Cookbook</a></li>
<li class="toctree-l1"><a class="reference internal" href="../benchmarks/benchmarks.html">Benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ref/ref.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infrastructure/infrastructure.html">Infrastructure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../services/services.html">Services</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="components.html">Low-level Components</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="managed_memory/managed_memory.html">Managed Memory</a></li>
<li class="toctree-l2"><a class="reference internal" href="managed_memory/cy_managedmemory.html"><code class="code docutils literal notranslate"><span class="pre">dragon.managed_memory</span></code> – Managed Memory Cython Adapter</a></li>
<li class="toctree-l2"><a class="reference internal" href="unordered_map.html">Unordered Map</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Broadcast Component</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#client-api">Client API</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#structures">Structures</a></li>
<li class="toctree-l4"><a class="reference internal" href="#api">API</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#example">Example</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Dragon</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="components.html">Low-level Components</a></li>
      <li class="breadcrumb-item active">Broadcast Component</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/components/broadcast.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="broadcast-component">
<span id="broadcast"></span><h1>Broadcast Component<a class="headerlink" href="#broadcast-component" title="Permalink to this heading"></a></h1>
<p>The BCast object is an any to many payload broadcaster.</p>
<p>A BCast object is used for synchronization and communication from a process to one or more processes. Unlike
channels, it is not designed to be used in synchronization/communication between two processes, which could be
done using a channel and by sending a message from a sender to a receiver. Using a BCast object, many
processes can wait on the BCast object until a process has notified them that a payload is available via a
call to a trigger function. The payload is optional. The BCast object provides an efficient any to many
synchronization/communication structure.</p>
<figure class="align-default" id="id1">
<img alt="../_images/bcast.png" src="../_images/bcast.png" />
<figcaption>
<p><span class="caption-number">Fig. 51 </span><span class="caption-text"><strong>Figure 1: An Any to Many Broadcast Synchronization Object</strong></span><a class="headerlink" href="#id1" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>A BCast object is meant to be shared by multiple threads/processes. The object is first created by a process.
Then a serialized descriptor to it can be shared with other processes. Via this serialized descriptor other
processes may attach to the same BCast Object. So there is one <em>create</em> call and perhaps many
<em>attach</em> calls using the API below. When the BCast object is no longer
needed, all processes should <em>detach</em> or <em>destroy</em> object. The <em>destroy</em> API call should only be called once
per object.</p>
<p>The object can be triggered to provide its payload to waiters. There are four options for waiting.</p>
<blockquote>
<div><ul class="simple">
<li><p>Idle Wait - A process sleeps via a futex until it is triggered via a syscall. This is relatively
expensive, but has the advantage of completely suspending the process.</p></li>
<li><p>Spin Wait - A process sleeps by looping while taking advantage of any processor specific ability
to relenquish cycles to other processes while it it spinning.</p></li>
<li><p>Asynchronously Wait for a callback - The process continues executing and a thread handles the callback.</p></li>
<li><p>Asynchronously Wait for a signal - A signal handler for the signal must be installed by the programmer.</p></li>
</ul>
</div></blockquote>
<p>When creating a BCast object, the programmer must decide on the maximum sized payload that could be provided to waiters.
The programmer must also decide on the maximum number of spin waiters that will be allowed to spin on its trigger event.</p>
<p>Triggering processes may trigger one or all processes that are waiting on a BCast object.</p>
<blockquote>
<div><ul class="simple">
<li><p>When triggering occurs, all new waiters must wait until triggering is complete.</p></li>
<li><p>Only current waiters will be triggered.</p></li>
<li><p>The triggering process provides the payload to be distributed when trigger is called.</p></li>
<li><p>The triggering process wakes up all waiters or one waiter.</p></li>
<li><p>Each triggered waiter process returns from its BCast wait primitive, but before it returns
it copies the payload from the BCast object into the heap of the waiting process and provides
a pointer to the payload to the triggered waiting process.</p></li>
</ul>
</div></blockquote>
<figure class="align-default" id="id2">
<a class="reference internal image-reference" href="../_images/bcastflow.srms1.png"><img alt="../_images/bcastflow.srms1.png" src="../_images/bcastflow.srms1.png" style="width: 739.5px; height: 909.0px;" /></a>
<figcaption>
<p><span class="caption-number">Fig. 52 </span><span class="caption-text"><strong>Figure 2: Operations on a BCast Object</strong></span><a class="headerlink" href="#id2" title="Permalink to this image"></a></p>
</figcaption>
</figure>
<p>The flow diagram in Figure 2 shows an interaction with a BCast object and points out a few features/semantics of these
synchronization/communication objects. The flow of interaction proceeds as follows:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>The process T1 creates the BCast object and through some means, communicates its location to all the other
processes in this interaction.</p></li>
<li><p>In step 2 all the waiter processes begin to wait on the BCast object.</p></li>
<li><p>In step 3 Trigger One is called before W4 can initiate its wait. W4 must wait until triggering is complete.</p></li>
<li><p>At step 4 W1, W3, and W4 are waiters and Trigger All is called. The payload will be copied into the local heap of all
the processes.</p></li>
<li><p>While triggering is still happening, W2 wants to wait, but it will not be a waiter until triggering is complete.</p></li>
<li><p>It is also possible to sign up for an asynchronous notification via either a callback or a signal. In this step, the
process W3 signs up for a callback. The callback is called as a thread under the W3 process.</p></li>
<li><p>When Trigger All is called the callback to cb2 is initiated in a thread of process W3. Process W2 is unblocked as well.</p></li>
<li><p>When Trigger One is called by T4 there are no waiters on the object. Without a waiter, the Trigger call is invalid
and is rejected.</p></li>
</ol>
</div></blockquote>
<section id="client-api">
<span id="broadcastapi"></span><h2>Client API<a class="headerlink" href="#client-api" title="Permalink to this heading"></a></h2>
<p>This section documents the user-level C API.</p>
<section id="structures">
<h3>Structures<a class="headerlink" href="#structures" title="Permalink to this heading"></a></h3>
<section id="descriptors">
<h4>Descriptors<a class="headerlink" href="#descriptors" title="Permalink to this heading"></a></h4>
<p>At the user level there are two descriptor types that are used in interacting with a BCast object. The
dragonBCastDescr_t structure is an opaque handle to a BCast object. All interaction with a BCast object takes
place through an instance of this descriptor that has been initialized by calling one of the create functions.</p>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv418dragonBCastDescr_t">
<span id="_CPPv318dragonBCastDescr_t"></span><span id="_CPPv218dragonBCastDescr_t"></span><span id="dragonBCastDescr_t"></span><span class="target" id="structdragonBCastDescr__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dragonBCastDescr_t</span></span></span><a class="headerlink" href="#_CPPv418dragonBCastDescr_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>A BCast handle.</p>
<p>The internals of this structure should not be used directly. It provides an opaque handle to a BCast object. All manipulation of the BCast occurs via its API functions. A process gets a valid <a class="reference internal" href="#structdragonBCastDescr__t"><span class="std std-ref">dragonBCastDescr_t</span></a> handle by either creating or attaching to a BCast object using the same API calls. </p>
</dd></dl>

<p>A dragonBCastSerial_t structure is the descriptor for a serialized representation of the object. A serialized
representation can only be created for a BCast object created in managed memory with the dragon_bcast_create
call.</p>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv419dragonBCastSerial_t">
<span id="_CPPv319dragonBCastSerial_t"></span><span id="_CPPv219dragonBCastSerial_t"></span><span id="dragonBCastSerial_t"></span><span class="target" id="structdragonBCastSerial__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dragonBCastSerial_t</span></span></span><a class="headerlink" href="#_CPPv419dragonBCastSerial_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>A serialized BCast handle.</p>
<p>This structure should not be used directly. All manipulation of the BCast object occurs via its API functions. A process gets a valid serialized descriptor by calling serialize on a valid BCast object.</p>
<p>The data is a serialized representation of a BCast object that can be passed between processes/thread and used to attach to the same object in another process or thread. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N19dragonBCastSerial_t3lenE">
<span id="_CPPv3N19dragonBCastSerial_t3lenE"></span><span id="_CPPv2N19dragonBCastSerial_t3lenE"></span><span id="dragonBCastSerial_t::len__s"></span><span class="target" id="structdragonBCastSerial__t_1ab6999cfbf304d7a62c7cf2d3b1b1ce6e"></span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">len</span></span></span><a class="headerlink" href="#_CPPv4N19dragonBCastSerial_t3lenE" title="Permalink to this definition"></a><br /></dt>
<dd><p>The length of the serialized data </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N19dragonBCastSerial_t4dataE">
<span id="_CPPv3N19dragonBCastSerial_t4dataE"></span><span id="_CPPv2N19dragonBCastSerial_t4dataE"></span><span id="dragonBCastSerial_t::data__uint8_tP"></span><span class="target" id="structdragonBCastSerial__t_1ac140cb413ba92b8a57e20c3aac73adfd"></span><span class="n"><span class="pre">uint8_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="sig-name descname"><span class="n"><span class="pre">data</span></span></span><a class="headerlink" href="#_CPPv4N19dragonBCastSerial_t4dataE" title="Permalink to this definition"></a><br /></dt>
<dd><p>A pointer to the serialized data </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="attributes">
<h4>Attributes<a class="headerlink" href="#attributes" title="Permalink to this heading"></a></h4>
<p>Broadcast attributes may be specified when the BCast object is created.</p>
<dl class="cpp enum">
<dt class="sig sig-object cpp" id="_CPPv416dragonSyncType_t">
<span id="_CPPv316dragonSyncType_t"></span><span id="_CPPv216dragonSyncType_t"></span><span class="target" id="bcast_8h_1a0712d36ea854ed260f50251e738cf128"></span><span class="k"><span class="pre">enum</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dragonSyncType_t</span></span></span><a class="headerlink" href="#_CPPv416dragonSyncType_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Constants to specify synchronization between waiters and triggerers. </p>
<p>These constants are provided as part of the BCast attributes when a BCast is created. The default value of DRAGON_NO_SYNC means it is up to the application to decide on when triggering and waiting occur. When DRAGON_SYNC is specified, then a triggerer will wait until at least one waiter is waiting, providing synchronization between triggerers and waiters. The number of required waiters is provided in the BCast attributes. </p>
<p><em>Values:</em></p>
<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N16dragonSyncType_t14DRAGON_NO_SYNCE">
<span id="_CPPv3N16dragonSyncType_t14DRAGON_NO_SYNCE"></span><span id="_CPPv2N16dragonSyncType_t14DRAGON_NO_SYNCE"></span><span class="target" id="bcast_8h_1a0712d36ea854ed260f50251e738cf128a2c6d67847088e77c2edbcfbf0fc28162"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DRAGON_NO_SYNC</span></span></span><a class="headerlink" href="#_CPPv4N16dragonSyncType_t14DRAGON_NO_SYNCE" title="Permalink to this definition"></a><br /></dt>
<dd><p>When specified, triggering processes will never block waiting for waiters. This is the default. </p>
</dd></dl>

<dl class="cpp enumerator">
<dt class="sig sig-object cpp" id="_CPPv4N16dragonSyncType_t11DRAGON_SYNCE">
<span id="_CPPv3N16dragonSyncType_t11DRAGON_SYNCE"></span><span id="_CPPv2N16dragonSyncType_t11DRAGON_SYNCE"></span><span class="target" id="bcast_8h_1a0712d36ea854ed260f50251e738cf128aeb5608887e53aeee5765ec24cd2f42f1"></span><span class="k"><span class="pre">enumerator</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">DRAGON_SYNC</span></span></span><a class="headerlink" href="#_CPPv4N16dragonSyncType_t11DRAGON_SYNCE" title="Permalink to this definition"></a><br /></dt>
<dd><p>When specified, a triggerer will block, waiting for waiters on the BCast object. The required number of waiters is specified in the attributes of the BCast. </p>
</dd></dl>

</dd></dl>

<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv417dragonBCastAttr_t">
<span id="_CPPv317dragonBCastAttr_t"></span><span id="_CPPv217dragonBCastAttr_t"></span><span id="dragonBCastAttr_t"></span><span class="target" id="structdragonBCastAttr__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dragonBCastAttr_t</span></span></span><a class="headerlink" href="#_CPPv417dragonBCastAttr_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>BCast Attributes</p>
<p>This structure defines user selectable attributes of the BCast Synchronization object. The lock type used internally may be user specified. The sync_type is as described in dragonSyncType_t. If DRAGON_SYNC is specified, then the user is guaranteed that no trigger events will occur without a waiter. This is at the expense of the triggerer blocking should no waiter be presently waiting on the bcast, but provides a convenient synchronization mechanism while eliminating the possibility of a trigger event going unnoticed. The default is NO_SYNC for no synchronization between waiters and triggerers. </p>
<div class="breathe-sectiondef docutils container">
<p class="breathe-sectiondef-title rubric" id="breathe-section-title-public-members">Public Members</p>
<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17dragonBCastAttr_t9lock_typeE">
<span id="_CPPv3N17dragonBCastAttr_t9lock_typeE"></span><span id="_CPPv2N17dragonBCastAttr_t9lock_typeE"></span><span id="dragonBCastAttr_t::lock_type__dragonLockKind_t"></span><span class="target" id="structdragonBCastAttr__t_1af0df78701abbb8d79385c478576f9868"></span><span class="n"><span class="pre">dragonLockKind_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">lock_type</span></span></span><a class="headerlink" href="#_CPPv4N17dragonBCastAttr_t9lock_typeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>The lock type used within the BCast object </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17dragonBCastAttr_t9sync_typeE">
<span id="_CPPv3N17dragonBCastAttr_t9sync_typeE"></span><span id="_CPPv2N17dragonBCastAttr_t9sync_typeE"></span><span id="dragonBCastAttr_t::sync_type__dragonSyncType_t"></span><span class="target" id="structdragonBCastAttr__t_1ab630c9d79ee96a96a4189545fa4ef5f9"></span><a class="reference internal" href="#_CPPv416dragonSyncType_t" title="dragonSyncType_t"><span class="n"><span class="pre">dragonSyncType_t</span></span></a><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sync_type</span></span></span><a class="headerlink" href="#_CPPv4N17dragonBCastAttr_t9sync_typeE" title="Permalink to this definition"></a><br /></dt>
<dd><p>The synchronization requirement </p>
</dd></dl>

<dl class="cpp var">
<dt class="sig sig-object cpp" id="_CPPv4N17dragonBCastAttr_t8sync_numE">
<span id="_CPPv3N17dragonBCastAttr_t8sync_numE"></span><span id="_CPPv2N17dragonBCastAttr_t8sync_numE"></span><span id="dragonBCastAttr_t::sync_num__dragonULInt"></span><span class="target" id="structdragonBCastAttr__t_1a1f6b6840ef2ba867342d307356224ac5"></span><span class="n"><span class="pre">dragonULInt</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">sync_num</span></span></span><a class="headerlink" href="#_CPPv4N17dragonBCastAttr_t8sync_numE" title="Permalink to this definition"></a><br /></dt>
<dd><p>Only valid when DRAGON_SYNC is specified. This specifies the number of waiters that must be waiting before a trigger can occur. </p>
</dd></dl>

</div>
</dd></dl>

</section>
<section id="the-handle">
<h4>The Handle<a class="headerlink" href="#the-handle" title="Permalink to this heading"></a></h4>
<p>This is an internal handle, used internally only in interacting with the BCast object. It is materialized
within API calls by using the dragonBCastDescr_t descriptor to look up the handle in a umap structure for
BCast objects. In this way descriptor objects are completely opaque.</p>
<dl class="cpp struct">
<dt class="sig sig-object cpp" id="_CPPv413dragonBCast_t">
<span id="_CPPv313dragonBCast_t"></span><span id="_CPPv213dragonBCast_t"></span><span id="dragonBCast_t"></span><span class="target" id="structdragonBCast__t"></span><span class="k"><span class="pre">struct</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dragonBCast_t</span></span></span><a class="headerlink" href="#_CPPv413dragonBCast_t" title="Permalink to this definition"></a><br /></dt>
<dd></dd></dl>

</section>
</section>
<section id="api">
<h3>API<a class="headerlink" href="#api" title="Permalink to this heading"></a></h3>
<p>These are the user-facing API calls for BCast objects.</p>
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417dragon_bcast_size6size_t6size_tP17dragonBCastAttr_tP6size_t">
<span id="_CPPv317dragon_bcast_size6size_t6size_tP17dragonBCastAttr_tP6size_t"></span><span id="_CPPv217dragon_bcast_size6size_t6size_tP17dragonBCastAttr_tP6size_t"></span><span id="dragon_bcast_size__s.s.dragonBCastAttr_tP.sP"></span><span class="target" id="bcast_8h_1a68f0e25a1b700e47b7efe12f6af9bdb6"></span><span class="n"><span class="pre">dragonError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dragon_bcast_size</span></span></span><span class="sig-paren">(</span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">max_payload_sz</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">max_spinsig_num</span></span>, <a class="reference internal" href="#_CPPv417dragonBCastAttr_t" title="dragonBCastAttr_t"><span class="n"><span class="pre">dragonBCastAttr_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">attr</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">size</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417dragon_bcast_size6size_t6size_tP17dragonBCastAttr_tP6size_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Compute the size of space needed to host a bcast object. </p>
<p>When creating a bcast synchronization object in pre-allocated memory, this function returns the required size for a given payload maximum size and a maximum number of spin/async notification waiters. The maximum number of waiters using either spin wait or asynchronous signal notification must be known when this function is called to compute the required memory size.</p>
<p>You must call dragon_bcast_attr_init to initialize attr before calling this function unless you want all the defaults. If you want default behavior, attr may be NULL.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>max_payload_sz</strong> – The maximum number of bytes that will be needed to store the payload to be broadcast to others.</p></li>
<li><p><strong>max_spinsig_num</strong> – The maximum number of spinner waiters and async waiters that will wait on this BCast object.</p></li>
<li><p><strong>attr</strong> – The other attributes of the object. Some of these may impact the size.</p></li>
<li><p><strong>size</strong> – A pointer to a size_t variable to hold the required size. This will be the required number of bytes needed to hold this object in memory.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DRAGON_SUCCESS or an error code indicating the problem. </p>
</dd>
</dl>
</dd></dl>

<p><strong>Example Usage</strong></p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="kt">size_t</span><span class="w"> </span><span class="n">sz</span><span class="p">;</span><span class="w"></span>
<span class="n">dragonError_t</span><span class="w"> </span><span class="n">err</span><span class="p">;</span><span class="w"></span>
<span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_size</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">sz</span><span class="p">);</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">DRAGON_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// take some action</span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<hr class="docutils" />
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv422dragon_bcast_attr_initP17dragonBCastAttr_t">
<span id="_CPPv322dragon_bcast_attr_initP17dragonBCastAttr_t"></span><span id="_CPPv222dragon_bcast_attr_initP17dragonBCastAttr_t"></span><span id="dragon_bcast_attr_init__dragonBCastAttr_tP"></span><span class="target" id="bcast_8h_1a59b6ea8077c2cfcc6af9423884495ec5"></span><span class="n"><span class="pre">dragonError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dragon_bcast_attr_init</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv417dragonBCastAttr_t" title="dragonBCastAttr_t"><span class="n"><span class="pre">dragonBCastAttr_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">attr</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv422dragon_bcast_attr_initP17dragonBCastAttr_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Initialize a BCast Attributes Structure. </p>
<p>When creating a bcast synchronization object certain attributes may be supplied to affect how the object behaves. This attr_init function initializes the attributes structure to default values which then may be subsequently overridden before creating the BCast object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>attr</strong> – A pointer to the attribute structure for a BCast object.<ul class="simple">
<li></li>
</ul>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DRAGON_SUCCESS or a return code to indicate what problem occurred. </p>
</dd>
</dl>
</dd></dl>

<p><strong>Example Usage</strong></p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">dragonBCastAttr_t</span><span class="w"> </span><span class="n">attr</span><span class="p">;</span><span class="w"></span>
<span class="cm">/* initialize an BCast attributes structure</span>
<span class="cm">   to default attributes */</span><span class="w"></span>
<span class="n">dragon_bcast_attr_init</span><span class="p">(</span><span class="o">&amp;</span><span class="n">attr</span><span class="p">);</span><span class="w"></span>
</pre></div>
</div>
<hr class="docutils" />
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv422dragon_bcast_create_atPv6size_t6size_t6size_tP17dragonBCastAttr_tP18dragonBCastDescr_t">
<span id="_CPPv322dragon_bcast_create_atPv6size_t6size_t6size_tP17dragonBCastAttr_tP18dragonBCastDescr_t"></span><span id="_CPPv222dragon_bcast_create_atPv6size_t6size_t6size_tP17dragonBCastAttr_tP18dragonBCastDescr_t"></span><span id="dragon_bcast_create_at__voidP.s.s.s.dragonBCastAttr_tP.dragonBCastDescr_tP"></span><span class="target" id="bcast_8h_1ab508204550e43190b3a3a853d3a19a02"></span><span class="n"><span class="pre">dragonError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dragon_bcast_create_at</span></span></span><span class="sig-paren">(</span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">loc</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">alloc_sz</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">max_payload_sz</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">max_spinsig_num</span></span>, <a class="reference internal" href="#_CPPv417dragonBCastAttr_t" title="dragonBCastAttr_t"><span class="n"><span class="pre">dragonBCastAttr_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">attr</span></span>, <a class="reference internal" href="#_CPPv418dragonBCastDescr_t" title="dragonBCastDescr_t"><span class="n"><span class="pre">dragonBCastDescr_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">bd</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv422dragon_bcast_create_atPv6size_t6size_t6size_tP17dragonBCastAttr_tP18dragonBCastDescr_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Create a BCast object in pre-allocated memory for use in sharing a payload. </p>
<p>Create a BCast object in the pre-allocated memory pointed to by loc, with max_payload_sz and initialize the handle to it in bd. BCast objects are on-node only objects. The max_payload_sz must be greater than or equal to 0. The memory in which the BCast object is to be created must start on a word boundary. Four byte (i.e. word) boundary alignment is required.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loc</strong> – The location in memory where this BCast object will be located.</p></li>
<li><p><strong>alloc_sz</strong> – The size of the allocation pointed to by loc.</p></li>
<li><p><strong>max_payload_sz</strong> – The maximum size payload to be allowed for this object.</p></li>
<li><p><strong>max_spinsig_num</strong> – The maximum number of spin/async notification waiters on this object.</p></li>
<li><p><strong>attr</strong> – Attributes that control the behavior of this object.</p></li>
<li><p><strong>bd</strong> – The BCast’s descriptor handle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DRAGON_SUCCESS or a return code to indicate what problem occurred. </p>
</dd>
</dl>
</dd></dl>

<p><strong>Example Usage</strong></p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">dragonError_t</span><span class="w"> </span><span class="n">err</span><span class="p">;</span><span class="w"></span>
<span class="kt">size_t</span><span class="w"> </span><span class="n">sz</span><span class="p">;</span><span class="w"></span>
<span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_size</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">sz</span><span class="p">);</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">DRAGON_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// take some action</span>
<span class="p">}</span><span class="w"></span>
<span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="n">sz</span><span class="p">);</span><span class="w"></span>
<span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_create_at</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span><span class="w"> </span><span class="mi">256</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bd</span><span class="p">);</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">DRAGON_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// take some action</span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<hr class="docutils" />
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419dragon_bcast_createP23dragonMemoryPoolDescr_t6size_t6size_tP17dragonBCastAttr_tP18dragonBCastDescr_t">
<span id="_CPPv319dragon_bcast_createP23dragonMemoryPoolDescr_t6size_t6size_tP17dragonBCastAttr_tP18dragonBCastDescr_t"></span><span id="_CPPv219dragon_bcast_createP23dragonMemoryPoolDescr_t6size_t6size_tP17dragonBCastAttr_tP18dragonBCastDescr_t"></span><span id="dragon_bcast_create__dragonMemoryPoolDescr_tP.s.s.dragonBCastAttr_tP.dragonBCastDescr_tP"></span><span class="target" id="bcast_8h_1a272a74cbe319c211dfd0bd921b08eee6"></span><span class="n"><span class="pre">dragonError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dragon_bcast_create</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="../ref/core/c/managed_memory.html#_CPPv423dragonMemoryPoolDescr_t" title="dragonMemoryPoolDescr_t"><span class="n"><span class="pre">dragonMemoryPoolDescr_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">pd</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">max_payload_sz</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">max_spinsig_num</span></span>, <a class="reference internal" href="#_CPPv417dragonBCastAttr_t" title="dragonBCastAttr_t"><span class="n"><span class="pre">dragonBCastAttr_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">attr</span></span>, <a class="reference internal" href="#_CPPv418dragonBCastDescr_t" title="dragonBCastDescr_t"><span class="n"><span class="pre">dragonBCastDescr_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">bd</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419dragon_bcast_createP23dragonMemoryPoolDescr_t6size_t6size_tP17dragonBCastAttr_tP18dragonBCastDescr_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Create a BCast object in a managed memory pool for use in sharing a payload. </p>
<p>Create a BCast object in the given memory pool, with max_payload_sz and initialize the handle to it in bd. BCast objects are on-node only objects. The max_payload_sz must be greater than or equal to 0.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>pd</strong> – A pool descriptor where the BCast object will be created.</p></li>
<li><p><strong>max_payload_sz</strong> – The maximum size payload to be allowed for this object.</p></li>
<li><p><strong>max_spinsig_num</strong> – The maximum number of spin/async notification waiters on this object.</p></li>
<li><p><strong>attr</strong> – Attributes that control the behavior of this object.</p></li>
<li><p><strong>bd</strong> – The BCast’s descriptor handle.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DRAGON_SUCCESS or a return code to indicate what problem occurred. </p>
</dd>
</dl>
</dd></dl>

<p><strong>Example Usage</strong></p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">dragonMemoryPoolDescr_t</span><span class="w"> </span><span class="n">pool</span><span class="p">;</span><span class="w"></span>
<span class="c1">// create a memory pool and initialize the descriptor</span>
<span class="n">dragonBCastDescr_t</span><span class="w"> </span><span class="n">bd</span><span class="p">;</span><span class="w"></span>
<span class="n">dragonError_t</span><span class="w"> </span><span class="n">err</span><span class="p">;</span><span class="w"></span>

<span class="c1">// create in memory pool</span>
<span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_create</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pool</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bd</span><span class="p">);</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">DRAGON_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// take some action</span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<hr class="docutils" />
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv420dragon_bcast_destroyP18dragonBCastDescr_t">
<span id="_CPPv320dragon_bcast_destroyP18dragonBCastDescr_t"></span><span id="_CPPv220dragon_bcast_destroyP18dragonBCastDescr_t"></span><span id="dragon_bcast_destroy__dragonBCastDescr_tP"></span><span class="target" id="bcast_8h_1afcbb1ecfdd55290469184b32ec1f95a1"></span><span class="n"><span class="pre">dragonError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dragon_bcast_destroy</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv418dragonBCastDescr_t" title="dragonBCastDescr_t"><span class="n"><span class="pre">dragonBCastDescr_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">bd</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv420dragon_bcast_destroyP18dragonBCastDescr_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Destroy a BCast object. </p>
<p>When done using a BCast object, destroy should be called once to release the pool resources used by the object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bd</strong> – The BCast’s descriptor handle.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DRAGON_SUCCESS or a return code to indicate what problem occurred. </p>
</dd>
</dl>
</dd></dl>

<p><strong>Example Usage</strong></p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">dragonMemoryPoolDescr_t</span><span class="w"> </span><span class="n">pool</span><span class="p">;</span><span class="w"></span>
<span class="c1">// create a memory pool and initialize the descriptor</span>
<span class="n">dragonBCastDescr_t</span><span class="w"> </span><span class="n">bd</span><span class="p">;</span><span class="w"></span>
<span class="n">dragonError_t</span><span class="w"> </span><span class="n">err</span><span class="p">;</span><span class="w"></span>

<span class="c1">// create in memory pool</span>
<span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_create</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pool</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bd</span><span class="p">);</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">DRAGON_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// take some action</span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// use it then destroy it.</span>
<span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_destroy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bd</span><span class="p">);</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">DRAGON_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// take some action</span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<hr class="docutils" />
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419dragon_bcast_attachP19dragonBCastSerial_tP18dragonBCastDescr_t">
<span id="_CPPv319dragon_bcast_attachP19dragonBCastSerial_tP18dragonBCastDescr_t"></span><span id="_CPPv219dragon_bcast_attachP19dragonBCastSerial_tP18dragonBCastDescr_t"></span><span id="dragon_bcast_attach__dragonBCastSerial_tP.dragonBCastDescr_tP"></span><span class="target" id="bcast_8h_1ad26597f96d753edb55f855ded6ad6e86"></span><span class="n"><span class="pre">dragonError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dragon_bcast_attach</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv419dragonBCastSerial_t" title="dragonBCastSerial_t"><span class="n"><span class="pre">dragonBCastSerial_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">serial</span></span>, <a class="reference internal" href="#_CPPv418dragonBCastDescr_t" title="dragonBCastDescr_t"><span class="n"><span class="pre">dragonBCastDescr_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">bd</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419dragon_bcast_attachP19dragonBCastSerial_tP18dragonBCastDescr_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Attach to a BCast Object. </p>
<p>A serialized descriptor can be shared between processes. A process may attach to a BCast Object using one of these serialized descriptors.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bd_ser</strong> – The serialized BCast object descriptor.</p></li>
<li><p><strong>bd</strong> – A BCast descriptor handle to be initialized by this call.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DRAGON_SUCCESS or a return code to indicate what problem occurred. </p>
</dd>
</dl>
</dd></dl>

<p><strong>Example Usage</strong></p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">dragonBCastDescr_t</span><span class="w"> </span><span class="n">bd</span><span class="p">,</span><span class="w"> </span><span class="n">bd2</span><span class="p">;</span><span class="w"></span>
<span class="n">dragonBCastSerial_t</span><span class="w"> </span><span class="n">bd_ser</span><span class="p">;</span><span class="w"></span>
<span class="n">dragonError_t</span><span class="w"> </span><span class="n">err</span><span class="p">;</span><span class="w"></span>

<span class="c1">// create in memory pool</span>
<span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_create</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pool</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bd</span><span class="p">);</span><span class="w"></span>

<span class="n">check_result</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">DRAGON_SUCCESS</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_passed</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_attempted</span><span class="p">);</span><span class="w"></span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">DRAGON_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// take some action</span>
<span class="p">}</span><span class="w"></span>

<span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_serialize</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bd</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bd_ser</span><span class="p">);</span><span class="w"></span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">DRAGON_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// take some action</span>
<span class="p">}</span><span class="w"></span>

<span class="c1">// presumably someplace where we don&#39;t have access</span>
<span class="c1">// to bd.</span>
<span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_attach</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bd_ser</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bd2</span><span class="p">);</span><span class="w"></span>

<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">DRAGON_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// take some action</span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<hr class="docutils" />
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv419dragon_bcast_detachP18dragonBCastDescr_t">
<span id="_CPPv319dragon_bcast_detachP18dragonBCastDescr_t"></span><span id="_CPPv219dragon_bcast_detachP18dragonBCastDescr_t"></span><span id="dragon_bcast_detach__dragonBCastDescr_tP"></span><span class="target" id="bcast_8h_1a952f6b0c271b1886c43069d6cb0e8118"></span><span class="n"><span class="pre">dragonError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dragon_bcast_detach</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv418dragonBCastDescr_t" title="dragonBCastDescr_t"><span class="n"><span class="pre">dragonBCastDescr_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">bd</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv419dragon_bcast_detachP18dragonBCastDescr_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Detach from a BCast object. </p>
<p>When done using a BCast object, detach can be called to end the use of the BCast’s handle in the current process. Calling detach does not release any of the shared resources of this object but will release any resources local to this process.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bd</strong> – The BCast’s descriptor handle.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DRAGON_SUCCESS or a return code to indicate what problem occurred. </p>
</dd>
</dl>
</dd></dl>

<p><strong>Example Usage</strong></p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_detach</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bd</span><span class="p">);</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">DRAGON_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// take some action</span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<hr class="docutils" />
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv422dragon_bcast_serializePK18dragonBCastDescr_tP19dragonBCastSerial_t">
<span id="_CPPv322dragon_bcast_serializePK18dragonBCastDescr_tP19dragonBCastSerial_t"></span><span id="_CPPv222dragon_bcast_serializePK18dragonBCastDescr_tP19dragonBCastSerial_t"></span><span id="dragon_bcast_serialize__dragonBCastDescr_tCP.dragonBCastSerial_tP"></span><span class="target" id="bcast_8h_1a6b9599b9a0d3f72f4a94583201419dfb"></span><span class="n"><span class="pre">dragonError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dragon_bcast_serialize</span></span></span><span class="sig-paren">(</span><span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="#_CPPv418dragonBCastDescr_t" title="dragonBCastDescr_t"><span class="n"><span class="pre">dragonBCastDescr_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">bd</span></span>, <a class="reference internal" href="#_CPPv419dragonBCastSerial_t" title="dragonBCastSerial_t"><span class="n"><span class="pre">dragonBCastSerial_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">bd_ser</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv422dragon_bcast_serializePK18dragonBCastDescr_tP19dragonBCastSerial_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Serialize a BCast Object. </p>
<p>When sharing a BCast object, a serialied descriptor can be created by calling this function. This serialized descriptor contains data that when shared can be used to attach to the BCast object from another process. This function is only valid to call on a BCast object created via the create function call. The create_at api call does not support serialization.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bd</strong> – The BCast’s descriptor handle.</p></li>
<li><p><strong>bd_ser</strong> – The serialized descriptor created/initialized by this call.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DRAGON_SUCCESS or a return code to indicate what problem occurred. </p>
</dd>
</dl>
</dd></dl>

<p><strong>Example Usage</strong></p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_serialize</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bd</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bd_ser</span><span class="p">);</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">DRAGON_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// take some action</span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<hr class="docutils" />
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424dragon_bcast_serial_freeP19dragonBCastSerial_t">
<span id="_CPPv324dragon_bcast_serial_freeP19dragonBCastSerial_t"></span><span id="_CPPv224dragon_bcast_serial_freeP19dragonBCastSerial_t"></span><span id="dragon_bcast_serial_free__dragonBCastSerial_tP"></span><span class="target" id="bcast_8h_1adce70179ce49fcea203dc64514592c77"></span><span class="n"><span class="pre">dragonError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dragon_bcast_serial_free</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv419dragonBCastSerial_t" title="dragonBCastSerial_t"><span class="n"><span class="pre">dragonBCastSerial_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">bd_ser</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424dragon_bcast_serial_freeP19dragonBCastSerial_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Free a BCast serialized descriptor. </p>
<p>When a BCast serialized descriptor is no longer needed, it should be freed. Calling this function frees the resources used by this serialized descriptor only which does not free a serialized descriptor shared with other processes and does not free the underlying SyncObject’s resources.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>bd_ser</strong> – A BCast serialized descriptor.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DRAGON_SUCCESS or a return code to indicate what problem occurred. </p>
</dd>
</dl>
</dd></dl>

<p><strong>Example Usage</strong></p>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_serial_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bd_ser</span><span class="p">);</span><span class="w"></span>
<span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">DRAGON_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="w">    </span><span class="c1">// take some action</span>
<span class="p">}</span><span class="w"></span>
</pre></div>
</div>
<hr class="docutils" />
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv417dragon_bcast_waitP18dragonBCastDescr_t16dragonWaitMode_tPK10timespec_tPPvP6size_t16dragonReleaseFunPv">
<span id="_CPPv317dragon_bcast_waitP18dragonBCastDescr_t16dragonWaitMode_tPK10timespec_tPPvP6size_t16dragonReleaseFunPv"></span><span id="_CPPv217dragon_bcast_waitP18dragonBCastDescr_t16dragonWaitMode_tPK10timespec_tPPvP6size_t16dragonReleaseFunPv"></span><span id="dragon_bcast_wait__dragonBCastDescr_tP.dragonWaitMode_t.timespec_tCP.voidPP.sP.dragonReleaseFun.voidP"></span><span class="target" id="bcast_8h_1a11f8adefc860e443383627473ae5cbe9"></span><span class="n"><span class="pre">dragonError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dragon_bcast_wait</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv418dragonBCastDescr_t" title="dragonBCastDescr_t"><span class="n"><span class="pre">dragonBCastDescr_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">bd</span></span>, <a class="reference internal" href="../ref/native/C/control_structures.html#_CPPv416dragonWaitMode_t" title="dragonWaitMode_t"><span class="n"><span class="pre">dragonWaitMode_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">wait_mode</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">timespec_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">timer</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">payload</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">payload_sz</span></span>, <span class="n"><span class="pre">dragonReleaseFun</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">release_fun</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">release_arg</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv417dragon_bcast_waitP18dragonBCastDescr_t16dragonWaitMode_tPK10timespec_tPPvP6size_t16dragonReleaseFunPv" title="Permalink to this definition"></a><br /></dt>
<dd><p>Wait for the BCast object to be triggered. </p>
<p>Perform a wait on the BCast object specified by handle bd. The calling process will block until it is triggered by a call to one of the two trigger functions or until the timeout expires. If <em>timeout</em> is <em>NULL</em> then the process waits indefinitely.</p>
<p>Waiting can fail for a few reasons. If spin wait is specified and there are more spin waiters than the allowable configured maxium, this call will fail. If this is a synchronized BCast and sync_num processes are already waiting on this BCast, then this call will fail. In all cases, if the call fails an appropriate return code is returned to the caller and should be checked.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bd</strong> – The BCast descriptor handle.</p></li>
<li><p><strong>wait_mode</strong> – Either DRAGON_IDLE_WAIT or DRAGON_SPIN_WAIT. Idle waiting is more resource friendly, while spin waiting has better performance when there are enough cores to be dedicated to spin waiting. There is a fixed size limit to the number of spin waiters. If that value is exceeded, the BCast will revert to idle waiting until more spin wait slots open up. Preference is given to waking up spin waiters first. See dragon_bcast_trigger_one or trigger_all.</p></li>
<li><p><strong>timer</strong> – is the timeout value. If it is <em>NULL</em> then spin wait indefinitely.</p></li>
<li><p><strong>payload</strong> – is a pointer to where a pointer will be stored for the payload. This will refer to space that was allocated on the heap for the calling process and must be freed once the process is done with the payload.</p></li>
<li><p><strong>payload_sz</strong> – is a pointer to the variable where the actual payload size will stored.</p></li>
<li><p><strong>release_fun</strong> – If NULL is provided, this argument is ignored. Otherwise, it is a pointer to a function that takes one argument. Any return value of the function will be ignored. This function will be called once the waiter has become an official waiter of the BCast object or if the wait has to return prematurely because of an error.</p></li>
<li><p><strong>release_arg</strong> – If release_fun is not NULL, then this is passed as an an argument to the release_fun function. The type of this argument is assumed to be a pointer to something.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DRAGON_SUCCESS or a return code to indicate what problem occurred. </p>
</dd>
</dl>
</dd></dl>

<hr class="docutils" />
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv428dragon_bcast_notify_callbackP18dragonBCastDescr_tPvK16dragonWaitMode_tPK10timespec_t16dragonReleaseFunPv19dragonBCastCallback">
<span id="_CPPv328dragon_bcast_notify_callbackP18dragonBCastDescr_tPvK16dragonWaitMode_tPK10timespec_t16dragonReleaseFunPv19dragonBCastCallback"></span><span id="_CPPv228dragon_bcast_notify_callbackP18dragonBCastDescr_tPvK16dragonWaitMode_tPK10timespec_t16dragonReleaseFunPv19dragonBCastCallback"></span><span id="dragon_bcast_notify_callback__dragonBCastDescr_tP.voidP.dragonWaitMode_tC.timespec_tCP.dragonReleaseFun.voidP.dragonBCastCallback"></span><span class="target" id="bcast_8h_1a3331b826b98390b6778e25ddce9fe5bb"></span><span class="n"><span class="pre">dragonError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dragon_bcast_notify_callback</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv418dragonBCastDescr_t" title="dragonBCastDescr_t"><span class="n"><span class="pre">dragonBCastDescr_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">bd</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">user_def_ptr</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../ref/native/C/control_structures.html#_CPPv416dragonWaitMode_t" title="dragonWaitMode_t"><span class="n"><span class="pre">dragonWaitMode_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">wait_mode</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">timespec_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">timer</span></span>, <span class="n"><span class="pre">dragonReleaseFun</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">release_fun</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">release_arg</span></span>, <span class="n"><span class="pre">dragonBCastCallback</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">cb</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv428dragon_bcast_notify_callbackP18dragonBCastDescr_tPvK16dragonWaitMode_tPK10timespec_t16dragonReleaseFunPv19dragonBCastCallback" title="Permalink to this definition"></a><br /></dt>
<dd><p>Request an asynchronous notification when one of the BCast object’s trigger functions is called via a callback. The two arguments to this function are the BCast descriptor and a pointer to a callback function. The callback function should take five arguments as follows. </p>
<p><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">void</span> <span class="n">callback</span><span class="p">(</span><span class="n">dragonBCastDescr_t</span><span class="o">*</span> <span class="n">bd</span><span class="p">,</span> <span class="n">void</span><span class="o">*</span> <span class="n">payload</span><span class="p">,</span> <span class="n">size_t</span> <span class="n">payload_sz</span><span class="p">,</span> <span class="n">dragonError_t</span> <span class="n">rc</span><span class="p">,</span> <span class="n">char</span><span class="o">*</span> <span class="n">err_str</span><span class="p">)</span>
</pre></div>
</div>
 The BCast descriptor pointer is the first argument to the callback. A payload pointer is the second argument followed by the size of the payload as the third argument. Finally, the last two are the return code, indicating success or not, and the error string if not successful (NULL otherwise).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bd</strong> – The BCast’s descriptor handle.</p></li>
<li><p><strong>user_def_ptr</strong> – This is a user defined pointer, presumably to something that the callback needs to complete its work. It is passed to the callback as the first argument. It can be any pointer that the user desires including the <a class="reference internal" href="#structdragonBCastDescr__t"><span class="std std-ref">dragonBCastDescr_t</span></a> pointer.</p></li>
<li><p><strong>wait_mode</strong> – The type of waiting (.e.g SPIN_WAIT or IDLE_WAIT) that should be used.</p></li>
<li><p><strong>timer</strong> – is the timeout value. If it is <em>NULL</em> then wait indefinitely to call the callback.</p></li>
<li><p><strong>release_fun</strong> – is a function to call that will release some lock or resource after the callback has been registered as a waiter with the bcast. The release fun must take one argument, a void* pointer.</p></li>
<li><p><strong>release_arg</strong> – is an argument to pass to the release_fun when it is called.</p></li>
<li><p><strong>cb</strong> – The callback function to be called. The callback function signature must be as described in this functions description.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DRAGON_SUCCESS or a return code to indicate what problem occurred. </p>
</dd>
</dl>
</dd></dl>

<hr class="docutils" />
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv426dragon_bcast_notify_signalP18dragonBCastDescr_tK16dragonWaitMode_tPK10timespec_t16dragonReleaseFunPviPPvP6size_tP13dragonError_tPPc">
<span id="_CPPv326dragon_bcast_notify_signalP18dragonBCastDescr_tK16dragonWaitMode_tPK10timespec_t16dragonReleaseFunPviPPvP6size_tP13dragonError_tPPc"></span><span id="_CPPv226dragon_bcast_notify_signalP18dragonBCastDescr_tK16dragonWaitMode_tPK10timespec_t16dragonReleaseFunPviPPvP6size_tP13dragonError_tPPc"></span><span id="dragon_bcast_notify_signal__dragonBCastDescr_tP.dragonWaitMode_tC.timespec_tCP.dragonReleaseFun.voidP.i.voidPP.sP.dragonError_tP.cPP"></span><span class="target" id="bcast_8h_1a71c1269304290dfe5b1878ab3cabb5d6"></span><span class="n"><span class="pre">dragonError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dragon_bcast_notify_signal</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv418dragonBCastDescr_t" title="dragonBCastDescr_t"><span class="n"><span class="pre">dragonBCastDescr_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">bd</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><a class="reference internal" href="../ref/native/C/control_structures.html#_CPPv416dragonWaitMode_t" title="dragonWaitMode_t"><span class="n"><span class="pre">dragonWaitMode_t</span></span></a><span class="w"> </span><span class="n sig-param"><span class="pre">wait_mode</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">timespec_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">timer</span></span>, <span class="n"><span class="pre">dragonReleaseFun</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">release_fun</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">release_arg</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">sig</span></span>, <span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">payload_ptr</span></span>, <span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">payload_sz</span></span>, <span class="n"><span class="pre">dragonError_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">drc</span></span>, <span class="kt"><span class="pre">char</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">err_string</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv426dragon_bcast_notify_signalP18dragonBCastDescr_tK16dragonWaitMode_tPK10timespec_t16dragonReleaseFunPviPPvP6size_tP13dragonError_tPPc" title="Permalink to this definition"></a><br /></dt>
<dd><p>Request an asynchronous signal when one of the BCast object’s trigger functions is called. </p>
<p>The asynchronous signal can come in one of two forms. This function defines a signal to occur when a trigger event occurs. The payload_ptr pointer and payload_sz pointer will be used to initialize a pointer to the payload and the size of the payload. The drc pointer will refer to the return code indicating the success of the asynchronous notification.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bd</strong> – The BCast’s descriptor handle.</p></li>
<li><p><strong>timer</strong> – is the timeout value. If it is <em>NULL</em> then wait indefinitely to signal the caller.</p></li>
<li><p><strong>payload_ptr</strong> – The location in which to store a pointer to the payload when signal notification is requested.</p></li>
<li><p><strong>payload_sz</strong> – The location in which to store the payload size when signal notification is requested.</p></li>
<li><p><strong>rc</strong> – The location in which to store the asynchronous wait Dragon return code when signal notification is requested.</p></li>
<li><p><strong>err_string</strong> – A pointer to a string pointer. Upon return it will hold an error string if the the rc indicates that there was an error. The err_string must be freed once the application is done with it.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DRAGON_SUCCESS or a return code to indicate what problem occurred. </p>
</dd>
</dl>
</dd></dl>

<hr class="docutils" />
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424dragon_bcast_trigger_oneP18dragonBCastDescr_tPK10timespec_tPKvK6size_t">
<span id="_CPPv324dragon_bcast_trigger_oneP18dragonBCastDescr_tPK10timespec_tPKvK6size_t"></span><span id="_CPPv224dragon_bcast_trigger_oneP18dragonBCastDescr_tPK10timespec_tPKvK6size_t"></span><span id="dragon_bcast_trigger_one__dragonBCastDescr_tP.timespec_tCP.voidCP.sC"></span><span class="target" id="bcast_8h_1ac582000c11096d142a520f8afca98aab"></span><span class="n"><span class="pre">dragonError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dragon_bcast_trigger_one</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv418dragonBCastDescr_t" title="dragonBCastDescr_t"><span class="n"><span class="pre">dragonBCastDescr_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">bd</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">timespec_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">timeout</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">payload</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">payload_sz</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424dragon_bcast_trigger_oneP18dragonBCastDescr_tPK10timespec_tPKvK6size_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Unblock one blocked process waiting on this BCast bbject. </p>
<p>Triggers one blocked process waiting on this BCast object. If there is no payload, the payload pointer must be NULL and the payload_sz must be 0. Otherwise, the payload_sz bytes are copied from the address in payload to the object’s shared payload area so it is available to any processes waiting on this object.</p>
<p>Preference is given to trigger a spin waiter if one is available. If no spin waiters are waiting, then an idle waiter is triggered.</p>
<p>If the BCast object is synchronized, this method cannot be called to trigger just one waiter. On a synchronized BCast, only dragon_bcast_trigger_all may be called, even if the sync_num is set to 1 for the BCast.</p>
<p>If a process is waiting asynchronously and chosen by this call, a signal will be initiated or a callback will be called, depending on how the asynchronous notification was requested.</p>
<p>When DRAGON_SUCCESS is returned, this call successfully blocked until one waiting processes has picked up its payload.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bd</strong> – The BCast’s descriptor handle.</p></li>
<li><p><strong>timer</strong> – A timeout value. If the triggerd process does not complete its triggering within the timeout period, this process will get a DRAGON_TIMEOUT return code. A value of NULL means to wait forever for triggering to complete.</p></li>
<li><p><strong>payload</strong> – A pointer to the payload the triggering process wants to disseminate.</p></li>
<li><p><strong>payload_sz</strong> – The size of the payload to be disseminated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DRAGON_SUCCESS or a return code to indicate what problem occurred. </p>
</dd>
</dl>
</dd></dl>

<hr class="docutils" />
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424dragon_bcast_trigger_allP18dragonBCastDescr_tPK10timespec_tPKvK6size_t">
<span id="_CPPv324dragon_bcast_trigger_allP18dragonBCastDescr_tPK10timespec_tPKvK6size_t"></span><span id="_CPPv224dragon_bcast_trigger_allP18dragonBCastDescr_tPK10timespec_tPKvK6size_t"></span><span id="dragon_bcast_trigger_all__dragonBCastDescr_tP.timespec_tCP.voidCP.sC"></span><span class="target" id="bcast_8h_1ac45dc4438f8fedf40667ba5e4cb30966"></span><span class="n"><span class="pre">dragonError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dragon_bcast_trigger_all</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv418dragonBCastDescr_t" title="dragonBCastDescr_t"><span class="n"><span class="pre">dragonBCastDescr_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">bd</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">timespec_t</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">timeout</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="kt"><span class="pre">void</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">payload</span></span>, <span class="k"><span class="pre">const</span></span><span class="w"> </span><span class="n"><span class="pre">size_t</span></span><span class="w"> </span><span class="n sig-param"><span class="pre">payload_sz</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424dragon_bcast_trigger_allP18dragonBCastDescr_tPK10timespec_tPKvK6size_t" title="Permalink to this definition"></a><br /></dt>
<dd><p>Unblock all blocked processes waiting on this BCast bbject. </p>
<p>Triggers all blocked processes waiting on this BCast object. If there is no payload, the payload pointer must be NULL and the payload_sz must be 0. Otherwise, the payload_sz bytes are copied from the address in payload to the object’s shared payload area so it is available to any processes waiting on this object.</p>
<p>If the BCast object is synchronized, this call will block until there are sync_num number of waiters waiting on the BCast as specifed in the attributes when the BCast was created.</p>
<p>If waiting processes are waiting asynchronously, a signal will be initiated or a callback will be called, depending on how the asynchronous notification was requested.</p>
<p>When DRAGON_SUCCESS is returned, this call successfully blocked until all waiting processes had picked up their payloads.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bd</strong> – The BCast’s descriptor handle.</p></li>
<li><p><strong>timer</strong> – A timeout value. If all triggered processes do not complete triggering within the timeout period, this process will get a DRAGON_TIMEOUT return code. A value of NULL means to wait forever for triggering to complete.</p></li>
<li><p><strong>payload</strong> – A pointer to the payload the triggering process wants to disseminate.</p></li>
<li><p><strong>payload_sz</strong> – The size of the payload to be disseminated.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DRAGON_SUCCESS or a return code to indicate what problem occurred. </p>
</dd>
</dl>
</dd></dl>

<hr class="docutils" />
<dl class="cpp function">
<dt class="sig sig-object cpp" id="_CPPv424dragon_bcast_num_waitingP18dragonBCastDescr_tPi">
<span id="_CPPv324dragon_bcast_num_waitingP18dragonBCastDescr_tPi"></span><span id="_CPPv224dragon_bcast_num_waitingP18dragonBCastDescr_tPi"></span><span id="dragon_bcast_num_waiting__dragonBCastDescr_tP.iP"></span><span class="target" id="bcast_8h_1af8072f7cad86e9a74f60d6696ee68020"></span><span class="n"><span class="pre">dragonError_t</span></span><span class="w"> </span><span class="sig-name descname"><span class="n"><span class="pre">dragon_bcast_num_waiting</span></span></span><span class="sig-paren">(</span><a class="reference internal" href="#_CPPv418dragonBCastDescr_t" title="dragonBCastDescr_t"><span class="n"><span class="pre">dragonBCastDescr_t</span></span></a><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">bd</span></span>, <span class="kt"><span class="pre">int</span></span><span class="w"> </span><span class="p"><span class="pre">*</span></span><span class="n sig-param"><span class="pre">num_waiters</span></span><span class="sig-paren">)</span><a class="headerlink" href="#_CPPv424dragon_bcast_num_waitingP18dragonBCastDescr_tPi" title="Permalink to this definition"></a><br /></dt>
<dd><p>Get the number of waiting processes on this BCast object. </p>
<p>Return the number of waiting processes on this BCast object.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bd</strong> – The BCast’s descriptor handle.</p></li>
<li><p><strong>num_waiters</strong> – A pointer to an integer variable where the number waiting will be stored.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>DRAGON_SUCCESS or a return code to indicate what problem occurred. </p>
</dd>
</dl>
</dd></dl>

</section>
</section>
<section id="example">
<h2>Example<a class="headerlink" href="#example" title="Permalink to this heading"></a></h2>
<p>This creates a BCast object. FIXME - This example is not complete. Placeholder only.</p>
<div class="literal-block-wrapper docutils container" id="id3">
<div class="code-block-caption"><span class="caption-number">Listing 37 </span><span class="caption-text"><strong>Figure 1: A BCast Example</strong></span><a class="headerlink" href="#id3" title="Permalink to this code"></a></div>
<div class="highlight-C notranslate"><div class="highlight"><pre><span></span><span class="linenos">  1</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;dragon/bcast.h&gt;</span><span class="cp"></span>
<span class="linenos">  2</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;dragon/return_codes.h&gt;</span><span class="cp"></span>
<span class="linenos">  3</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdio.h&gt;</span><span class="cp"></span>
<span class="linenos">  4</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;stdlib.h&gt;</span><span class="cp"></span>
<span class="linenos">  5</span><span class="cp">#include</span><span class="w"> </span><span class="cpf">&lt;time.h&gt;</span><span class="cp"></span>
<span class="linenos">  6</span>
<span class="linenos">  7</span><span class="cp">#define TRUE 1</span>
<span class="linenos">  8</span><span class="cp">#define FALSE 0</span>
<span class="linenos">  9</span>
<span class="linenos"> 10</span><span class="cp">#define SERFILE &quot;bcast_serialized.dat&quot;</span>
<span class="linenos"> 11</span><span class="cp">#define MFILE &quot;bcast_test&quot;</span>
<span class="linenos"> 12</span><span class="cp">#define M_UID 0</span>
<span class="linenos"> 13</span>
<span class="linenos"> 14</span><span class="cp">#define FAILED 1</span>
<span class="linenos"> 15</span><span class="cp">#define SUCCESS 0</span>
<span class="linenos"> 16</span>
<span class="linenos"> 17</span><span class="kt">int</span><span class="w"> </span><span class="nf">create_pool</span><span class="p">(</span><span class="n">dragonMemoryPoolDescr_t</span><span class="o">*</span><span class="w"> </span><span class="n">mpool</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="linenos"> 18</span><span class="w">    </span><span class="cm">/* Create a memory pool to allocate messages and a Channel out of */</span><span class="w"></span>
<span class="linenos"> 19</span><span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">mem_size</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1UL</span><span class="o">&lt;&lt;</span><span class="mi">31</span><span class="p">;</span><span class="w"></span>
<span class="linenos"> 20</span><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Allocating pool of size %lu bytes.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">mem_size</span><span class="p">);</span><span class="w"></span>
<span class="linenos"> 21</span>
<span class="linenos"> 22</span><span class="w">    </span><span class="n">dragonError_t</span><span class="w"> </span><span class="n">derr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_memory_pool_create</span><span class="p">(</span><span class="n">mpool</span><span class="p">,</span><span class="w"> </span><span class="n">mem_size</span><span class="p">,</span><span class="w"> </span><span class="n">MFILE</span><span class="p">,</span><span class="w"> </span><span class="n">M_UID</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">);</span><span class="w"></span>
<span class="linenos"> 23</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">derr</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">DRAGON_SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="linenos"> 24</span><span class="w">        </span><span class="kt">char</span><span class="w"> </span><span class="o">*</span><span class="w"> </span><span class="n">errstr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_getlasterrstr</span><span class="p">();</span><span class="w"></span>
<span class="linenos"> 25</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Failed to create the memory pool.  Got EC=%i</span><span class="se">\n</span><span class="s">ERRSTR = </span><span class="se">\n</span><span class="s">%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="n">derr</span><span class="p">,</span><span class="w"> </span><span class="n">errstr</span><span class="p">);</span><span class="w"></span>
<span class="linenos"> 26</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">FAILED</span><span class="p">;</span><span class="w"></span>
<span class="linenos"> 27</span><span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="linenos"> 28</span>
<span class="linenos"> 29</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">SUCCESS</span><span class="p">;</span><span class="w"></span>
<span class="linenos"> 30</span><span class="p">}</span><span class="w"></span>
<span class="linenos"> 31</span>
<span class="linenos"> 32</span><span class="kt">void</span><span class="w"> </span><span class="nf">check_result</span><span class="p">(</span><span class="n">dragonError_t</span><span class="w"> </span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">dragonError_t</span><span class="w"> </span><span class="n">expected_err</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">tests_passed</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="o">*</span><span class="w"> </span><span class="n">tests_attempted</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="linenos"> 33</span><span class="w">    </span><span class="p">(</span><span class="o">*</span><span class="n">tests_attempted</span><span class="p">)</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="linenos"> 34</span>
<span class="linenos"> 35</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">err</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">expected_err</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="linenos"> 36</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Test %d Failed with error code %s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">tests_attempted</span><span class="p">,</span><span class="w"> </span><span class="n">dragon_get_rc_string</span><span class="p">(</span><span class="n">err</span><span class="p">));</span><span class="w"></span>
<span class="linenos"> 37</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;%s</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">dragon_getlasterrstr</span><span class="p">());</span><span class="w"></span>
<span class="linenos"> 38</span><span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="linenos"> 39</span><span class="w">    </span><span class="k">else</span><span class="w"></span>
<span class="linenos"> 40</span><span class="w">        </span><span class="p">(</span><span class="o">*</span><span class="n">tests_passed</span><span class="p">)</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="linenos"> 41</span><span class="p">}</span><span class="w"></span>
<span class="linenos"> 42</span>
<span class="linenos"> 43</span><span class="kt">int</span><span class="w"> </span><span class="nf">main</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">argc</span><span class="p">,</span><span class="w"> </span><span class="kt">char</span><span class="o">*</span><span class="w"> </span><span class="n">argv</span><span class="p">[])</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="linenos"> 44</span>
<span class="linenos"> 45</span><span class="w">    </span><span class="n">timespec_t</span><span class="w"> </span><span class="n">t1</span><span class="p">,</span><span class="w"> </span><span class="n">t2</span><span class="p">;</span><span class="w"></span>
<span class="linenos"> 46</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">tests_passed</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="linenos"> 47</span><span class="w">    </span><span class="kt">int</span><span class="w"> </span><span class="n">tests_attempted</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="linenos"> 48</span><span class="w">    </span><span class="n">dragonMemoryPoolDescr_t</span><span class="w"> </span><span class="n">pool</span><span class="p">;</span><span class="w"></span>
<span class="linenos"> 49</span>
<span class="linenos"> 50</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">create_pool</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pool</span><span class="p">)</span><span class="w"> </span><span class="o">!=</span><span class="w"> </span><span class="n">SUCCESS</span><span class="p">)</span><span class="w"> </span><span class="p">{</span><span class="w"></span>
<span class="linenos"> 51</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Could not create memory pool for bcast tests.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">);</span><span class="w"></span>
<span class="linenos"> 52</span><span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">FAILED</span><span class="p">;</span><span class="w"></span>
<span class="linenos"> 53</span><span class="w">    </span><span class="p">}</span><span class="w"></span>
<span class="linenos"> 54</span>
<span class="linenos"> 55</span><span class="w">    </span><span class="n">dragonBCastDescr_t</span><span class="w"> </span><span class="n">bd</span><span class="p">,</span><span class="w"> </span><span class="n">bd2</span><span class="p">;</span><span class="w"></span>
<span class="linenos"> 56</span><span class="w">    </span><span class="n">dragonBCastSerial_t</span><span class="w"> </span><span class="n">bd_ser</span><span class="p">;</span><span class="w"></span>
<span class="linenos"> 57</span>
<span class="linenos"> 58</span><span class="w">    </span><span class="n">dragonError_t</span><span class="w"> </span><span class="n">err</span><span class="p">;</span><span class="w"></span>
<span class="linenos"> 59</span>
<span class="linenos"> 60</span><span class="w">    </span><span class="c1">// create in memory pool</span>
<span class="linenos"> 61</span><span class="w">    </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_create</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pool</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bd</span><span class="p">);</span><span class="w"></span>
<span class="linenos"> 62</span>
<span class="linenos"> 63</span><span class="w">    </span><span class="n">check_result</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">DRAGON_SUCCESS</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_passed</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_attempted</span><span class="p">);</span><span class="w"></span>
<span class="linenos"> 64</span>
<span class="linenos"> 65</span><span class="w">    </span><span class="c1">// destroy from memory pool</span>
<span class="linenos"> 66</span><span class="w">    </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_destroy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bd</span><span class="p">);</span><span class="w"></span>
<span class="linenos"> 67</span>
<span class="linenos"> 68</span><span class="w">    </span><span class="n">check_result</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">DRAGON_SUCCESS</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_passed</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_attempted</span><span class="p">);</span><span class="w"></span>
<span class="linenos"> 69</span>
<span class="linenos"> 70</span><span class="w">    </span><span class="c1">// destroy already destroyed bcast object</span>
<span class="linenos"> 71</span><span class="w">    </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_destroy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bd</span><span class="p">);</span><span class="w"></span>
<span class="linenos"> 72</span>
<span class="linenos"> 73</span><span class="w">    </span><span class="n">check_result</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">DRAGON_MAP_KEY_NOT_FOUND</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_passed</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_attempted</span><span class="p">);</span><span class="w"></span>
<span class="linenos"> 74</span>
<span class="linenos"> 75</span><span class="w">    </span><span class="kt">size_t</span><span class="w"> </span><span class="n">sz</span><span class="p">;</span><span class="w"></span>
<span class="linenos"> 76</span><span class="w">    </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_size</span><span class="p">(</span><span class="mi">256</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">sz</span><span class="p">);</span><span class="w"></span>
<span class="linenos"> 77</span>
<span class="linenos"> 78</span><span class="w">    </span><span class="n">check_result</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">DRAGON_SUCCESS</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_passed</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_attempted</span><span class="p">);</span><span class="w"></span>
<span class="linenos"> 79</span>
<span class="linenos"> 80</span><span class="w">    </span><span class="n">tests_attempted</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="linenos"> 81</span>
<span class="linenos"> 82</span><span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">sz</span><span class="w"> </span><span class="o">&lt;</span><span class="w"> </span><span class="mi">256</span><span class="p">)</span><span class="w"></span>
<span class="linenos"> 83</span><span class="w">        </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Test %d Failed. The required size was too small.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">tests_attempted</span><span class="p">);</span><span class="w"></span>
<span class="linenos"> 84</span><span class="w">    </span><span class="k">else</span><span class="w"></span>
<span class="linenos"> 85</span><span class="w">        </span><span class="n">tests_passed</span><span class="o">++</span><span class="p">;</span><span class="w"></span>
<span class="linenos"> 86</span>
<span class="linenos"> 87</span><span class="w">    </span><span class="kt">void</span><span class="o">*</span><span class="w"> </span><span class="n">ptr</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">malloc</span><span class="p">(</span><span class="n">sz</span><span class="p">);</span><span class="w"></span>
<span class="linenos"> 88</span>
<span class="linenos"> 89</span><span class="w">    </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_create_at</span><span class="p">(</span><span class="n">ptr</span><span class="p">,</span><span class="w"> </span><span class="mi">256</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bd</span><span class="p">);</span><span class="w"></span>
<span class="linenos"> 90</span>
<span class="linenos"> 91</span><span class="w">    </span><span class="n">check_result</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">DRAGON_SUCCESS</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_passed</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_attempted</span><span class="p">);</span><span class="w"></span>
<span class="linenos"> 92</span>
<span class="linenos"> 93</span><span class="w">    </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_serialize</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bd</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bd_ser</span><span class="p">);</span><span class="w"></span>
<span class="linenos"> 94</span>
<span class="linenos"> 95</span><span class="w">    </span><span class="n">check_result</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">DRAGON_BCAST_NOT_SERIALIZABLE</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_passed</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_attempted</span><span class="p">);</span><span class="w"></span>
<span class="linenos"> 96</span>
<span class="linenos"> 97</span><span class="w">    </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_destroy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bd</span><span class="p">);</span><span class="w"></span>
<span class="linenos"> 98</span>
<span class="linenos"> 99</span><span class="w">    </span><span class="n">check_result</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">DRAGON_SUCCESS</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_passed</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_attempted</span><span class="p">);</span><span class="w"></span>
<span class="linenos">100</span>
<span class="linenos">101</span><span class="w">    </span><span class="c1">// create in memory pool</span>
<span class="linenos">102</span><span class="w">    </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_create</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pool</span><span class="p">,</span><span class="w"> </span><span class="mi">128</span><span class="p">,</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span><span class="w"> </span><span class="nb">NULL</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bd</span><span class="p">);</span><span class="w"></span>
<span class="linenos">103</span>
<span class="linenos">104</span><span class="w">    </span><span class="n">check_result</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">DRAGON_SUCCESS</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_passed</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_attempted</span><span class="p">);</span><span class="w"></span>
<span class="linenos">105</span>
<span class="linenos">106</span><span class="w">    </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_serialize</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bd</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bd_ser</span><span class="p">);</span><span class="w"></span>
<span class="linenos">107</span>
<span class="linenos">108</span><span class="w">    </span><span class="n">check_result</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">DRAGON_SUCCESS</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_passed</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_attempted</span><span class="p">);</span><span class="w"></span>
<span class="linenos">109</span>
<span class="linenos">110</span><span class="w">    </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_attach</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bd_ser</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bd2</span><span class="p">);</span><span class="w"></span>
<span class="linenos">111</span>
<span class="linenos">112</span><span class="w">    </span><span class="n">check_result</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">DRAGON_SUCCESS</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_passed</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_attempted</span><span class="p">);</span><span class="w"></span>
<span class="linenos">113</span>
<span class="linenos">114</span><span class="w">    </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_detach</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bd2</span><span class="p">);</span><span class="w"></span>
<span class="linenos">115</span>
<span class="linenos">116</span><span class="w">    </span><span class="n">check_result</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">DRAGON_SUCCESS</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_passed</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_attempted</span><span class="p">);</span><span class="w"></span>
<span class="linenos">117</span>
<span class="linenos">118</span><span class="w">    </span><span class="c1">// This won&#39;t succeed because detaching the same BCast object just prior</span>
<span class="linenos">119</span><span class="w">    </span><span class="c1">// to this call, removes it from the umap. You can&#39;t detach and destroy</span>
<span class="linenos">120</span><span class="w">    </span><span class="c1">// the same BCast object.</span>
<span class="linenos">121</span><span class="w">    </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_destroy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bd</span><span class="p">);</span><span class="w"></span>
<span class="linenos">122</span>
<span class="linenos">123</span><span class="w">    </span><span class="n">check_result</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">DRAGON_MAP_KEY_NOT_FOUND</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_passed</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_attempted</span><span class="p">);</span><span class="w"></span>
<span class="linenos">124</span>
<span class="linenos">125</span><span class="w">    </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_attach</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bd_ser</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">bd2</span><span class="p">);</span><span class="w"></span>
<span class="linenos">126</span>
<span class="linenos">127</span><span class="w">    </span><span class="n">check_result</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">DRAGON_SUCCESS</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_passed</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_attempted</span><span class="p">);</span><span class="w"></span>
<span class="linenos">128</span>
<span class="linenos">129</span><span class="w">    </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_serial_free</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bd_ser</span><span class="p">);</span><span class="w"></span>
<span class="linenos">130</span>
<span class="linenos">131</span><span class="w">    </span><span class="n">check_result</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">DRAGON_SUCCESS</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_passed</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_attempted</span><span class="p">);</span><span class="w"></span>
<span class="linenos">132</span>
<span class="linenos">133</span><span class="w">    </span><span class="n">err</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">dragon_bcast_destroy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">bd2</span><span class="p">);</span><span class="w"></span>
<span class="linenos">134</span>
<span class="linenos">135</span><span class="w">    </span><span class="n">check_result</span><span class="p">(</span><span class="n">err</span><span class="p">,</span><span class="w"> </span><span class="n">DRAGON_SUCCESS</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_passed</span><span class="p">,</span><span class="w"> </span><span class="o">&amp;</span><span class="n">tests_attempted</span><span class="p">);</span><span class="w"></span>
<span class="linenos">136</span>
<span class="linenos">137</span><span class="w">    </span><span class="n">dragon_memory_pool_destroy</span><span class="p">(</span><span class="o">&amp;</span><span class="n">pool</span><span class="p">);</span><span class="w"></span>
<span class="linenos">138</span>
<span class="linenos">139</span><span class="w">    </span><span class="n">printf</span><span class="p">(</span><span class="s">&quot;Passed %d of %d tests.</span><span class="se">\n</span><span class="s">&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">tests_passed</span><span class="p">,</span><span class="w"> </span><span class="n">tests_attempted</span><span class="p">);</span><span class="w"></span>
<span class="linenos">140</span>
<span class="linenos">141</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="mi">0</span><span class="p">;</span><span class="w"></span>
<span class="linenos">142</span><span class="p">}</span><span class="w"></span>
</pre></div>
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="unordered_map.html" class="btn btn-neutral float-left" title="Unordered Map" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Hewlett Packard Enterprise.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>