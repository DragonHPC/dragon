<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>SciPy Image Convolution Benchmark &mdash; Dragon  documentation</title>
      <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../_static/copybutton.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/custom.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/sphinx_highlight.js"></script>
        <script src="../_static/clipboard.min.js"></script>
        <script src="../_static/copybutton.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="FAQ" href="../faq/faq.html" />
    <link rel="prev" title="Benchmarks" href="benchmarks.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> Dragon
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../start/start.html">Getting Started</a></li>
<li class="toctree-l1"><a class="reference internal" href="../uguide/uguide.html">Users Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../pguide/pguide.html">Programming Guide</a></li>
<li class="toctree-l1"><a class="reference internal" href="../cbook/cbook.html">Solution Cookbook</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="benchmarks.html">Benchmarks</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">SciPy Image Convolution Benchmark</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#arguments-list">Arguments list</a></li>
<li class="toctree-l3"><a class="reference internal" href="#how-to-run">How to run</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#system-information">System Information</a></li>
<li class="toctree-l4"><a class="reference internal" href="#single-node">Single node</a></li>
<li class="toctree-l4"><a class="reference internal" href="#multi-node">Multi-node</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../faq/faq.html">FAQ</a></li>
<li class="toctree-l1"><a class="reference internal" href="../ref/ref.html">API Reference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infrastructure/infrastructure.html">Infrastructure</a></li>
<li class="toctree-l1"><a class="reference internal" href="../services/services.html">Services</a></li>
<li class="toctree-l1"><a class="reference internal" href="../components/components.html">Low-level Components</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">Dragon</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="benchmarks.html">Benchmarks</a></li>
      <li class="breadcrumb-item active">SciPy Image Convolution Benchmark</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/benchmarks/scipy_image.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="scipy-image-convolution-benchmark">
<h1>SciPy Image Convolution Benchmark<a class="headerlink" href="#scipy-image-convolution-benchmark" title="Permalink to this heading"></a></h1>
<p>This is an image processing benchmark. It performs image convolution using the SciPy package.
The computation is done in parallel by using a pool of workers.
For a given number of iterations, the benchmark reports the average time and standard
deviation of the computation.</p>
<p>We can succeed scaling with respect to
* the number of workers,
* the workload, by controlling the size of the NumPy array (image) that each worker is working on
and the number of work items, i.e., the number of images that the workers will work on.</p>
<div class="literal-block-wrapper docutils container" id="id1">
<div class="code-block-caption"><span class="caption-number">Listing 23 </span><span class="caption-text"><strong>scipy_scale_work.py: A SciPy image convolution benchmark</strong></span><a class="headerlink" href="#id1" title="Permalink to this code"></a></div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="kn">import</span> <span class="nn">dragon</span>
<span class="linenos"> 2</span><span class="kn">import</span> <span class="nn">argparse</span>
<span class="linenos"> 3</span><span class="kn">import</span> <span class="nn">multiprocessing</span>
<span class="linenos"> 4</span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="linenos"> 5</span><span class="kn">import</span> <span class="nn">scipy.signal</span>
<span class="linenos"> 6</span><span class="kn">import</span> <span class="nn">time</span>
<span class="linenos"> 7</span>
<span class="linenos"> 8</span><span class="k">def</span> <span class="nf">get_args</span><span class="p">():</span>
<span class="linenos"> 9</span>    <span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s2">&quot;Basic SciPy test&quot;</span><span class="p">)</span>
<span class="linenos">10</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--num_workers&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;number of workers&quot;</span><span class="p">)</span>
<span class="linenos">11</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--iterations&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;number of iterations to do&quot;</span><span class="p">)</span>
<span class="linenos">12</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<span class="linenos">13</span>        <span class="s2">&quot;--burns&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;number of iterations to burn/ignore in order to warm up&quot;</span>
<span class="linenos">14</span>    <span class="p">)</span>
<span class="linenos">15</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--dragon&quot;</span><span class="p">,</span> <span class="n">action</span><span class="o">=</span><span class="s2">&quot;store_true&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;run with dragon objs&quot;</span><span class="p">)</span>
<span class="linenos">16</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s2">&quot;--size&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">1000</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;size of the array&quot;</span><span class="p">)</span>
<span class="linenos">17</span>    <span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span>
<span class="linenos">18</span>        <span class="s2">&quot;--mem&quot;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="p">(</span><span class="mi">32</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">),</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;overall footprint of image dataset to process&quot;</span>
<span class="linenos">19</span>    <span class="p">)</span>
<span class="linenos">20</span>    <span class="n">my_args</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>
<span class="linenos">21</span>
<span class="linenos">22</span>    <span class="k">return</span> <span class="n">my_args</span>
<span class="linenos">23</span>
<span class="linenos">24</span><span class="k">def</span> <span class="nf">f</span><span class="p">(</span><span class="n">args</span><span class="p">):</span>
<span class="linenos">25</span>    <span class="n">image</span><span class="p">,</span> <span class="n">random_filter</span> <span class="o">=</span> <span class="n">args</span>
<span class="linenos">26</span>    <span class="c1"># Do some image processing.</span>
<span class="linenos">27</span>    <span class="k">return</span> <span class="n">scipy</span><span class="o">.</span><span class="n">signal</span><span class="o">.</span><span class="n">convolve2d</span><span class="p">(</span><span class="n">image</span><span class="p">,</span> <span class="n">random_filter</span><span class="p">)[::</span><span class="mi">5</span><span class="p">,</span> <span class="p">::</span><span class="mi">5</span><span class="p">]</span>
<span class="linenos">28</span>
<span class="linenos">29</span><span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
<span class="linenos">30</span>    <span class="n">args</span> <span class="o">=</span> <span class="n">get_args</span><span class="p">()</span>
<span class="linenos">31</span>
<span class="linenos">32</span>    <span class="k">if</span> <span class="n">args</span><span class="o">.</span><span class="n">dragon</span><span class="p">:</span>
<span class="linenos">33</span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;using dragon runtime&quot;</span><span class="p">)</span>
<span class="linenos">34</span>        <span class="n">multiprocessing</span><span class="o">.</span><span class="n">set_start_method</span><span class="p">(</span><span class="s2">&quot;dragon&quot;</span><span class="p">)</span>
<span class="linenos">35</span>    <span class="k">else</span><span class="p">:</span>
<span class="linenos">36</span>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;using regular mp libs/calls&quot;</span><span class="p">)</span>
<span class="linenos">37</span>        <span class="n">multiprocessing</span><span class="o">.</span><span class="n">set_start_method</span><span class="p">(</span><span class="s2">&quot;spawn&quot;</span><span class="p">)</span>
<span class="linenos">38</span>
<span class="linenos">39</span>    <span class="n">num_cpus</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">num_workers</span>
<span class="linenos">40</span>
<span class="linenos">41</span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of workers: </span><span class="si">{</span><span class="n">num_cpus</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">42</span>    <span class="n">pool</span> <span class="o">=</span> <span class="n">multiprocessing</span><span class="o">.</span><span class="n">Pool</span><span class="p">(</span><span class="n">num_cpus</span><span class="p">)</span>
<span class="linenos">43</span>    <span class="n">image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">args</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="linenos">44</span>    <span class="n">nimages</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">float</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">mem</span><span class="p">)</span> <span class="o">/</span> <span class="nb">float</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>
<span class="linenos">45</span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of images: </span><span class="si">{</span><span class="n">nimages</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="linenos">46</span>    <span class="n">images</span> <span class="o">=</span> <span class="p">[]</span>
<span class="linenos">47</span>    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nimages</span><span class="p">):</span>
<span class="linenos">48</span>        <span class="n">images</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="n">args</span><span class="o">.</span><span class="n">size</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">size</span><span class="p">)))</span>
<span class="linenos">49</span>    <span class="n">filters</span> <span class="o">=</span> <span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">4</span><span class="p">))</span> <span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">nimages</span><span class="p">)]</span>
<span class="linenos">50</span>
<span class="linenos">51</span>    <span class="n">all_iter</span> <span class="o">=</span> <span class="n">args</span><span class="o">.</span><span class="n">iterations</span> <span class="o">+</span> <span class="n">args</span><span class="o">.</span><span class="n">burns</span>
<span class="linenos">52</span>    <span class="n">results</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">all_iter</span><span class="p">)</span>
<span class="linenos">53</span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">all_iter</span><span class="p">):</span>
<span class="linenos">54</span>        <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="linenos">55</span>        <span class="n">res</span> <span class="o">=</span> <span class="n">pool</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">f</span><span class="p">,</span> <span class="nb">zip</span><span class="p">(</span><span class="n">images</span><span class="p">,</span> <span class="n">filters</span><span class="p">))</span>
<span class="linenos">56</span>        <span class="k">del</span> <span class="n">res</span>
<span class="linenos">57</span>        <span class="n">finish</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">perf_counter</span><span class="p">()</span>
<span class="linenos">58</span>        <span class="n">results</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="n">finish</span> <span class="o">-</span> <span class="n">start</span>
<span class="linenos">59</span>
<span class="linenos">60</span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Average time: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="n">args</span><span class="o">.</span><span class="n">burns</span><span class="p">:]),</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> second(s)&quot;</span><span class="p">)</span>
<span class="linenos">61</span>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Standard deviation: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">results</span><span class="p">[</span><span class="n">args</span><span class="o">.</span><span class="n">burns</span><span class="p">:]),</span> <span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> second(s)&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<section id="arguments-list">
<h2>Arguments list<a class="headerlink" href="#arguments-list" title="Permalink to this heading"></a></h2>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="linenos"> 1</span><span class="go">dragon scipy_scale_work.py [-h] [--num_workers NUM_WORKERS] [--iterations ITERATIONS]</span>
<span class="linenos"> 2</span><span class="go">                           [--burns BURN_ITERATIONS] [--dragon] [--size IMAGE_SIZE]</span>
<span class="linenos"> 3</span><span class="go">                           [--mem MEMORY_FOOTPRINT]</span>
<span class="linenos"> 4</span>
<span class="linenos"> 5</span><span class="go">--num_workers       number of the workers, int, default=4</span>
<span class="linenos"> 6</span><span class="go">--iterations        number of iterations, int, default=10</span>
<span class="linenos"> 7</span><span class="go">--burns             number of iterations to burn, int, default=2</span>
<span class="linenos"> 8</span><span class="go">--dragon            use the Dragon calls, action=&quot;store_true&quot;</span>
<span class="linenos"> 9</span><span class="go">--size              size of the numpy array used to create an image, int, default=1000</span>
<span class="linenos">10</span><span class="go">--mem               overall memory footprint of image dataset to process, int, default=(32 * 1024 * 1024)</span>
</pre></div>
</div>
</section>
<section id="how-to-run">
<h2>How to run<a class="headerlink" href="#how-to-run" title="Permalink to this heading"></a></h2>
<section id="system-information">
<h3>System Information<a class="headerlink" href="#system-information" title="Permalink to this heading"></a></h3>
<p>We ran the experiments in a Cray XC-50 system,
with Intel Xeon(R) Platinum 8176 CPU &#64; 2.10GHz (28 cores per socket, single socket).</p>
<p>The Dragon version used is 0.3.</p>
</section>
<section id="single-node">
<h3>Single node<a class="headerlink" href="#single-node" title="Permalink to this heading"></a></h3>
<p><strong>Base Multiprocessing</strong></p>
<p>In order to use the standard multiprocessing library, this code can be run with
<code class="code docutils literal notranslate"><span class="pre">dragon</span> <span class="pre">scipy_scale_work.py</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="go">&gt; salloc --nodes=1 --exclusive</span>
<span class="linenos">2</span><span class="go">&gt; dragon scipy_scale_work.py --num_workers 4</span>
<span class="linenos">3</span><span class="go">[stdout: p_uid=4294967296] using regular mp libs/calls</span>
<span class="linenos">4</span><span class="go">Number of workers: 4</span>
<span class="linenos">5</span><span class="go">[stdout: p_uid=4294967296] Number of images: 33</span>
<span class="linenos">6</span><span class="go">Average time: 0.5 second(s)</span>
<span class="linenos">7</span><span class="go">Standard deviation: 0.01 second(s)</span>
</pre></div>
</div>
<p><strong>Dragon runtime</strong></p>
<p>In order to use Dragon runtime calls, run with <code class="code docutils literal notranslate"><span class="pre">dragon</span> <span class="pre">scipy_scale_work.py</span> <span class="pre">--dragon</span></code>:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="go">&gt; salloc --nodes=1 --exclusive</span>
<span class="linenos">2</span><span class="go">&gt; dragon scipy_scale_work.py --dragon --num_workers 4</span>
<span class="linenos">3</span><span class="go">[stdout: p_uid=4294967296] using dragon runtime</span>
<span class="linenos">4</span><span class="go">Number of workers: 4</span>
<span class="linenos">5</span><span class="go">[stdout: p_uid=4294967296] Number of images: 33</span>
<span class="linenos">6</span><span class="go">Average time: 0.39 second(s)</span>
<span class="linenos">7</span><span class="go">Standard deviation: 0.0 second(s)</span>
</pre></div>
</div>
<p>From the above results, we can see that Dragon outperforms Base Multiprocessing.</p>
</section>
<section id="multi-node">
<h3>Multi-node<a class="headerlink" href="#multi-node" title="Permalink to this heading"></a></h3>
<p><strong>Dragon runtime</strong></p>
<p>In multinode case, the placement of processes follows a round robin scheme. More information
can be found in <a class="reference internal" href="../pguide/owner.html#processes"><span class="std std-ref">Processes</span></a></p>
<p>For running on 2 nodes with 4 workers:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="go">&gt; salloc --nodes=2 --exclusive</span>
<span class="linenos">2</span><span class="go">&gt; dragon scipy_scale_work.py --dragon --num_workers 4</span>
<span class="linenos">3</span><span class="go">[stdout: p_uid=4294967296] using dragon runtime</span>
<span class="linenos">4</span><span class="go">Number of workers: 4</span>
<span class="linenos">5</span><span class="go">[stdout: p_uid=4294967296] Number of images: 33</span>
<span class="linenos">6</span><span class="go">Average time: 1.46 second(s)</span>
<span class="linenos">7</span><span class="go">Standard deviation: 0.02 second(s)</span>
</pre></div>
</div>
<p>For running on 2 nodes with 32 workers:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="go">&gt; salloc --nodes=2 --exclusive</span>
<span class="linenos">2</span><span class="go">&gt; dragon ./scipy_scale_work.py --dragon --num_workers 32</span>
<span class="linenos">3</span><span class="go">[stdout: p_uid=4294967296] using dragon runtime</span>
<span class="linenos">4</span><span class="go">Number of workers: 32</span>
<span class="linenos">5</span><span class="go">[stdout: p_uid=4294967296] Number of images: 33</span>
<span class="linenos">6</span><span class="go">Average time: 1.34 second(s)</span>
<span class="linenos">7</span><span class="go">Standard deviation: 0.61 second(s)</span>
</pre></div>
</div>
<p>For running on 4 nodes with 32 workers:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="go">&gt; salloc --nodes=4 --exclusive</span>
<span class="linenos">2</span><span class="go">&gt; dragon ./scipy_scale_work.py --dragon --num_workers 32</span>
<span class="linenos">3</span><span class="go">[stdout: p_uid=4294967296] using dragon runtime</span>
<span class="linenos">4</span><span class="go">Number of workers: 32</span>
<span class="linenos">5</span><span class="go">[stdout: p_uid=4294967296] Number of images: 33</span>
<span class="linenos">6</span><span class="go">Average time: 1.11 second(s)</span>
<span class="linenos">7</span><span class="go">Standard deviation: 0.02 second(s)</span>
</pre></div>
</div>
<p>In the above case, we keep the amount of work fixed, <code class="code docutils literal notranslate"><span class="pre">Number</span> <span class="pre">of</span> <span class="pre">images:</span> <span class="pre">33</span></code>, and we scale
the number of nodes or number of workers. We see that the performance keeps improving as expected.</p>
<p>Finally, we run on 64 nodes with 896 workers:</p>
<div class="highlight-console notranslate"><div class="highlight"><pre><span></span><span class="linenos">1</span><span class="go">&gt; salloc --nodes=64 --exclusive</span>
<span class="linenos">2</span><span class="go">&gt; dragon ./scipy_scale_work.py --dragon --mem 536870912 --size 256 --num_workers 896</span>
<span class="linenos">3</span><span class="go">[stdout: p_uid=4294967296] using dragon runtime</span>
<span class="linenos">4</span><span class="go">Number of workers: 896</span>
<span class="linenos">5</span><span class="go">[stdout: p_uid=4294967296] Number of images: 8192</span>
<span class="linenos">6</span><span class="go">Average time: 1.46 second(s)</span>
<span class="linenos">7</span><span class="go">Standard deviation: 0.03 second(s)</span>
</pre></div>
</div>
<p>In this last experiment, we scale the amount of nodes by a factor of 16, the number of workers by a factor of 28,
and the amount of work by a factor of 16. This is a substantially heavier experiment compared to the previous ones.
Dragon was able to scale and the performance almost remained the same as before.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="benchmarks.html" class="btn btn-neutral float-left" title="Benchmarks" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="../faq/faq.html" class="btn btn-neutral float-right" title="FAQ" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, Hewlett Packard Enterprise.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>